<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ì•ˆì‹¬CARE Â· ì¼ë°˜êµ¬ë§¤ / êµ¬ë…êµ¬ë§¤ ë¹„êµ + ìƒë‹´ìš© ìš”ì•½ PDF</title>
<style>
  :root{
    --brand:#c40000; --bg:#0a0f1e; --card:#0f172a;
    --line:#1f2a44; --pill:#0b1220; --muted:#9aa6c0; --radius:14px; --gap:12px;
    --hot-bg:#1b2a0a; --hot-border:#9bff6a; --hot-shadow:#2aff9a55;
  }
  *{box-sizing:border-box;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans KR",Arial,sans-serif;}
  body{margin:0;background:var(--bg);color:#e7eefb}
  .wrap{max-width:980px;margin:0 auto;padding:18px}
  .brandbar{display:flex;gap:12px;margin-bottom:10px;padding:16px;border:1px solid var(--line);
    border-radius:var(--radius);background:linear-gradient(90deg,rgba(196,0,0,.12),rgba(196,0,0,0))}
  .logo{display:flex;gap:12px;align-items:center}
  .logo img{width:48px;height:48px;border-radius:10px;object-fit:cover;display:block}
  .sub{color:var(--muted);font-size:12px;line-height:1.35}
  .card{background:var(--card);border:1px solid var(--line);border-radius:var(--radius);padding:16px;margin-bottom:14px}
  h1{margin:10px 0 6px;font-size:26px}
  h2{margin:8px 0 6px;font-size:18px}
  .muted{color:var(--muted);font-size:12px}
  .badge{padding:10px 14px;border-radius:12px;font-size:13px;border:1px solid var(--line);background:rgba(196,0,0,.12);color:#ffd2d2;cursor:pointer}
  input,select{width:100%;padding:12px;border-radius:12px;background:var(--pill);border:1px solid var(--line);color:#e7eefb;outline:none}
  input[type="checkbox"]{width:auto;transform:scale(1.1);margin-right:6px}
  .row{display:grid;grid-template-columns:1fr;gap:var(--gap)}
  .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:var(--gap)}
  .grid-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:var(--gap)}
  @media(min-width:740px){.row{grid-template-columns:1.2fr 1fr}}
  .table{width:100%;border-collapse:collapse}
  .table th,.table td{text-align:left;padding:10px 8px;border-bottom:1px dashed var(--line);font-size:14px}
  .kpi{display:flex;justify-content:space-between;align-items:center;gap:10px;padding:12px;background:var(--pill);border:1px solid var(--line);border-radius:12px}
  .highlight{color:#93f1cb;font-weight:700}
  .pill{display:inline-block;padding:6px 10px;border-radius:999px;font-size:12px;background:var(--pill);border:1px solid var(--line);color:#aac1e6}
  .right{text-align:right}
  .warn{color:#fbbf24;font-size:12px}
  .flex{display:flex;gap:10px;align-items:flex-start;flex-wrap:wrap}
  .grow{flex:1}

  /* ì…ë ¥/ì„ íƒ â€˜í•«ìŠ¤íŒŸâ€™ ê°•ì¡° */
  .hot label::before{content:"âœï¸ ì…ë ¥";margin-right:6px;color:#98f79e}
  .hot label{display:flex;justify-content:flex-start;gap:6px;align-items:center;margin-bottom:6px;font-weight:800}
  .hot input,.hot select{
    background:linear-gradient(0deg, var(--hot-bg), var(--pill));
    border:2px solid var(--hot-border);
    box-shadow:0 0 0 3px var(--hot-shadow);
  }
  .hot-tip{font-size:11px;color:#c9ffd8;margin-top:6px}
  .hot input:focus,.hot select:focus{box-shadow:0 0 0 4px #7dffb855}

  /* ë“œë¡­ë‹¤ìš´ ì˜µì…˜ ê°€ë…ì„± */
  select{appearance:none;background-color:#0e1628;color:#e7eefb}
  select:focus{border-color:var(--hot-border);box-shadow:0 0 0 3px var(--hot-shadow)}
  option{background-color:#0b1220;color:#e7eefb}
  optgroup{color:#aac1e6;background:#0b1220}

  /* ì¸ì‡„(PDF) ì „ìš© â€” ì‹œì¸ì„± ê°•í™” */
  #printSummary{display:none}
  @media print{
    @page{size:A4;margin:12mm}
    body{background:white;color:#111}
    .brandbar{display:none!important}   /* í—¤ë”(ì…ë ¥ì°½) ìˆ¨ê¹€ */
    #app{display:none!important}        /* í™”ë©´ìš© ë³¸ë¬¸ ìˆ¨ê¹€ */
    #printSummary{display:block!important}

    .ps-wrap{max-width:100%}
    .ps-title{font-weight:900;font-size:26px;margin:0 0 6px}
    .ps-sub{font-size:14px;color:#333;margin-bottom:6px}
    .ps-billto{
      display:grid;grid-template-columns:1fr 1fr;gap:8px;
      border:2px solid #111;border-radius:10px;padding:10px;margin:8px 0 12px
    }
    .ps-billto div{font-size:16px}
    .ps-billto b{display:inline-block;width:90px}
    .ps-kpis{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin:8px 0 12px}
    .ps-kpi{border:2px solid #111;border-radius:10px;padding:12px}
    .ps-kpi h3{margin:0 0 6px 0;font-size:15px}
    .ps-kpi .num{font-size:22px;font-weight:900}
    .ps-table{width:100%;border-collapse:collapse;margin-top:2px}
    .ps-table th,.ps-table td{border:1.8px solid #111;padding:8px 10px;font-size:15px}
    .ps-table th{background:#f4f6fb}
    .ps-note{border:2px solid #b91c1c;border-radius:10px;padding:10px;margin-top:12px;background:#fff5f5}
    .ps-note h3{margin:0 0 6px 0;color:#b91c1c;font-size:15px}
    .ps-note ul{margin:6px 0 0 18px;padding:0;font-size:14px}
    .ps-meta{margin-top:6px;font-size:13px;color:#333}
  }
</style>
</head>
<body>
<div class="wrap">

  <!-- í—¤ë”(ì…ë ¥ì°½) -->
  <div class="brandbar">
    <div class="logo">
      <img src="https://play-lh.googleusercontent.com/_uH9WIQdMGBGMoq-IXWmgvGD0AU72NSy3aTWA6FTPCGJwUcv9DRAQjf4HR83gPdvMjY" alt="LOTTE HIMART">
    </div>
    <div>
      <div style="font-weight:800;font-size:20px;">ì•ˆì‹¬CARE</div>
      <div class="sub">Total home service clean &amp; warranty<br>â†’í•˜ì´ë§ˆíŠ¸ ì‚¼ì²œí¬ì  í™ˆì„œë¹„ìŠ¤ì„¼í„°<br>ì œì‘ : ì„œë¹„ìŠ¤ì„¼í„°ì¥</div>
    </div>
    <div style="margin-left:auto" class="flex">
      <div class="hot" style="min-width:200px">
        <label>ê³ ê°ëª…</label>
        <input id="customer_name" placeholder="ì˜ˆ) í™ê¸¸ë™" />
        <div class="hot-tip">ì¸ì‡„ ì‹œ â€˜ê³ ê°ë‹˜â€™ ìë™ í‘œê¸°</div>
      </div>
      <div class="hot" style="min-width:220px">
        <label>ëª¨ë¸ëª…</label>
        <input id="model_name" placeholder="ì˜ˆ) ì˜¤ë¸Œì œâ€¦" />
        <div class="hot-tip">PDF ë³¸ë¬¸ì— í¼ì§í•˜ê²Œ í‘œê¸°</div>
      </div>
      <button class="badge" onclick="window.print()">ìƒë‹´ìš© ìš”ì•½ PDF</button>
    </div>
  </div>

  <!-- í™”ë©´ìš© ë³¸ë¬¸ -->
  <div id="app">
    <h1>ì¼ë°˜êµ¬ë§¤ / êµ¬ë…êµ¬ë§¤ ë¹„êµ</h1>

    <div class="row">
      <!-- ì¢Œì¸¡ ì…ë ¥ -->
      <div class="card">
        <h2>êµ¬ë… ì¡°ê±´ ì„ íƒ ë¹„êµ</h2>

        <div class="grid-2" style="margin-top:6px">
          <div class="hot">
            <label>ì¼ë°˜ êµ¬ë§¤ê°€ (ì›)</label>
            <input type="text" id="buy_price" value="1,390,000" inputmode="numeric">
            <div class="muted">ë¬´ìƒ A/S ë³´ì¦ê¸°ê°„ì€ <b>1ë…„ ê³ ì •</b>. (ë¶€ê°€ì„¸ í¬í•¨)</div>
          </div>
          <div class="hot">
            <label>êµ¬ë… ì›”ìš”ê¸ˆ (ì›)</label>
            <input type="text" id="sub_monthly" value="52,300" inputmode="numeric">
            <div class="muted">ì²« ë‹¬ ê²°ì œ <b>5%(ìµœëŒ€ 50,000ì›)</b> ì²­êµ¬í• ì¸ ìë™ ë°˜ì˜.</div>
          </div>
        </div>

        <div class="grid-3" style="margin-top:12px">
          <div class="hot">
            <label>êµ¬ë…ê¸°ê°„(= A/S ë³´ì¦)</label>
            <select id="sub_months">
              <option value="36" selected>36ê°œì›” (3ë…„)</option>
              <option value="60">60ê°œì›” (5ë…„)</option>
            </select>
          </div>
          <div class="hot">
            <label>ì œíœ´ì¹´ë“œ ìºì‹œë°±</label>
            <select id="cashback_tier">
              <option value="0">ì—†ìŒ</option>
              <option value="11000" selected>ì›” 30ë§Œì›â†‘ (11,000)</option>
              <option value="15000">ì›” 70ë§Œì›â†‘ (15,000)</option>
            </select>
          </div>
          <div class="hot">
            <label>í’ˆëª©ì„ íƒ</label>
            <select id="preset">
              <option value="NONE">ì„ íƒ ì—†ìŒ (ì—°ì¥ë³´ì¦ë§Œ)</option>
              <optgroup label="ì—ì–´ì»¨">
                <option value="SET-CLEAN-PAC|156000">ìŠ¤íƒ ë“œ (156,000)</option>
                <option value="SET-CLEAN-RAC|101000">ë²½ê±¸ì´ (101,000)</option>
                <option value="SET-CLEAN-2IN1|252000">2IN1 (252,000)</option>
                <option value="SET-CLEAN-3IN1|338000">3IN1 (338,000)</option>
              </optgroup>
              <optgroup label="ì„¸íƒê¸°">
                <option value="SET-CLEAN-WM|106000">ì¼ë°˜ (106,000)</option>
                <option value="SET-CLEAN-WM(DRUM)|170000">ë“œëŸ¼(ì¼ë°˜) (170,000)</option>
              </optgroup>
              <optgroup label="ê±´ì¡°ê¸°/ì˜ë¥˜ê´€ë¦¬ê¸°">
                <option value="SET-CLEAN-DRYER(NEW)|92000">ê±´ì¡°ê¸° ì „ëª¨ë¸ (92,000)</option>
                <option value="SET-CLEAN-STEAMCLOSET|68000">ì˜ë¥˜ê´€ë¦¬ê¸° ì „ëª¨ë¸ (68,000)</option>
              </optgroup>
              <optgroup label="ëƒ‰ì¥ê³ ">
                <option value="SET-CLEAN-REF|126000">ë‹¨ë¬¸í˜• (126,000)</option>
                <option value="SET-CLEAN-SBS|164000">ì–‘ë¬¸í˜• (164,000)</option>
              </optgroup>
              <optgroup label="ê¹€ëƒ‰">
                <option value="SET-CLEAN-KREF(UPDOOR)|99000">ëšœê»‘ì‹ (99,000)</option>
                <option value="SET-CLEAN-KREF(STAND)|121000">ìŠ¤íƒ ë“œ (121,000)</option>
                <option value="SET-CLEAN-KREF(4DOOR)|170000">4ë„ì–´ (170,000)</option>
              </optgroup>
              <optgroup label="ì‹ê¸°ì„¸ì²™ê¸°">
                <option value="SET-CLEAN-DW|84000">ì „ëª¨ë¸ (84,000)</option>
              </optgroup>
            </select>
            <div class="hot-tip">ì„ íƒ ì‹œ í´ë¦¬ë‹ 1íšŒ ë¹„ìš© ìë™ ë°˜ì˜</div>
          </div>
        </div>

        <div class="grid-3" style="margin-top:12px">
          <div>
            <label>í´ë¦¬ë‹ 1íšŒ ë¹„ìš©(ì›)</label>
            <input type="text" id="val_cleaning" value="80,000" inputmode="numeric">
            <div class="muted">í’ˆëª© ì„ íƒ ì‹œ ìë™ ë³€ê²½</div>
          </div>
          <div class="hot">
            <label>í´ë¦¬ë‹ íšŸìˆ˜</label>
            <select id="cleaning_count">
              <option value="1" selected>ìµœì†Œ 1íšŒ</option>
              <option value="2">2íšŒ</option>
              <option value="3">3íšŒ</option>
            </select>
          </div>
          <div>
            <label>ì—°ì¥ë³´ì¦ í™˜ì‚°ê°€(ì›)</label>
            <input type="text" id="val_warranty" value="50,000" inputmode="numeric">
            <div class="muted">ì¼ë°˜ êµ¬ë§¤ê°€ ê¸°ì¤€ ìë™ ê³„ì‚°(ìˆ˜ì • ê°€ëŠ¥). â€˜ì„ íƒ ì—†ìŒâ€™ì¼ ë•Œë§Œ í˜œíƒ ë°˜ì˜</div>
          </div>
        </div>

        <div class="grid-3" style="margin-top:12px">
          <div class="hot">
            <label>ë¶€í’ˆ/ì†Œëª¨í’ˆ í™˜ì‚°ê°€(ì›)</label>
            <input type="text" id="val_parts" value="0" inputmode="numeric" placeholder="ì˜ˆ: 10,000">
          </div>
          <div class="hot">
            <label>ë¶€í’ˆ/ì†Œëª¨í’ˆ í¬í•¨ ì—¬ë¶€ (êµ¬ë…)</label>
            <div><input type="checkbox" id="parts_included"><span class="muted">êµ¬ë… ì—´ì—ì„œë§Œ ì„ íƒ ê°€ëŠ¥</span></div>
          </div>
          <div class="hot">
            <label>ë¶€í’ˆ/ì†Œëª¨í’ˆ ë¹„ê³ </label>
            <input type="text" id="parts_note" placeholder="ì˜ˆ: ë°°í„°ë¦¬ êµì²´ 1íšŒ">
          </div>
        </div>

        <div class="grid-2" style="margin-top:12px">
          <div class="hot">
            <label>ì œí’ˆ êµ¬ë§¤ í˜œíƒ â†’ í¬ì¸íŠ¸/ìºì‹œë°± ë“± (ì›)</label>
            <input type="text" id="benefit_manual" value="0" inputmode="numeric" placeholder="ì˜ˆ: 30,000">
            <div class="hot-tip">ì¼ë°˜/êµ¬ë… ë™ì¼ ì°¨ê° (ë¶€ê°€ì„¸ í¬í•¨)</div>
          </div>
        </div>
      </div>

      <!-- ìš°ì¸¡ KPI -->
      <div class="card">
        <h2>í˜œíƒê°€ ìµœì¢… ë¹„êµğŸ‘“</h2>
        <div class="kpi" style="margin-top:8px"><span>ì¼ë°˜ êµ¬ë§¤ ì´ì•¡</span><strong id="kpi_buy">-</strong></div>
        <div class="kpi"><span>êµ¬ë…ê²°ì œ ìµœì¢…ê¸ˆì•¡(ì„ íƒ ìºì‹œë°± í¬í•¨)</span><strong id="kpi_final_incl_cb" class="highlight">-</strong></div>
        <div class="kpi"><span>êµ¬ë… í˜œíƒ ì ìš© í›„ ì‹¤ì§ˆê¸ˆì•¡</span><strong id="kpi_sub_net" class="highlight">-</strong></div>
        <p class="muted" style="margin-top:10px">ì‹¤ì§ˆê¸ˆì•¡ = (ì›”ìš”ê¸ˆ-ìºì‹œë°±)Ã—ê¸°ê°„ âˆ’ <b>ì²­êµ¬í• ì¸(ìµœì´ˆê²°ì œì˜ 5%, ìµœëŒ€ 50,000)</b> âˆ’ (ì—°ì¥ë³´ì¦+í´ë¦¬ë‹+ì†Œëª¨í’ˆ) âˆ’ ì œí’ˆêµ¬ë§¤í˜œíƒ</p>
        <p class="warn" id="warn_none" style="display:none;margin-top:10px">â€˜ì„ íƒ ì—†ìŒâ€™ ëª¨ë“œ: ì—°ì¥ë³´ì¦ë§Œ í˜œíƒìœ¼ë¡œ ë°˜ì˜ë©ë‹ˆë‹¤.</p>
      </div>
    </div>

    <!-- ìƒì„¸ ë¹„êµ -->
    <div class="card">
      <h2>ìƒì„¸ í˜œíƒ ë¹„êµ</h2>
      <table class="table" id="compare_table" style="margin-top:6px">
        <thead>
          <tr><th>í•­ëª©</th><th>ì¼ë°˜ êµ¬ë§¤</th><th>êµ¬ë… êµ¬ë§¤</th></tr>
        </thead>
        <tbody>
          <tr><td>êµ¬ë…êµ¬ë§¤ ìµœì´ˆê²°ì œ</td><td id="t_buy_price"></td><td id="t_sub_first"></td></tr>
          <tr><td>ì›” ë‚©ì…(ìºì‹œë°± ë°˜ì˜)</td><td class="muted">í•´ë‹¹ ì—†ìŒ</td><td id="t_sub_monthly"></td></tr>
          <tr><td>ì›” ë‚©ì… í•©ê³„</td><td class="muted">í•´ë‹¹ ì—†ìŒ</td><td id="t_sub_monthly_sum"></td></tr>
          <tr><td>ì´ ê¸°ê°„</td><td>ì¼ì‹œë¶ˆ/ì¹´ë“œì‚¬ ë‹¨ê¸°í• ë¶€</td><td id="t_sub_months"></td></tr>
          <tr><td>ë¬´ìƒ A/S ë³´ì¦</td><td><b>1ë…„</b> (ê³ ì •)</td><td id="t_sub_warranty"></td></tr>
          <tr><td>í´ë¦¬ë‹</td><td><span class="muted">ë³„ë„êµ¬ë§¤</span></td><td id="t_cleaning"></td></tr>
          <tr><td>ë¶€í’ˆ/ì†Œëª¨í’ˆ</td><td><span class="muted">ë³„ë„êµ¬ë§¤</span></td><td id="t_parts"></td></tr>
          <tr><td>ì´ì•¡(ì²­êµ¬í• ì¸ ë°˜ì˜)</td><td id="t_buy_total"></td><td id="t_sub_total"></td></tr>
          <tr><td>í˜œíƒ í™˜ì‚°ê°€</td><td class="muted">-</td><td id="t_benefit_value"></td></tr>
          <tr><td>ì œí’ˆêµ¬ë§¤ í˜œíƒ(ìˆ˜ê¸°)</td><td id="t_benefit_manual_buy"></td><td id="t_benefit_manual_sub"></td></tr>
          <tr><td><b>í˜œíƒ ì ìš© í›„ ì‹¤ì§ˆê¸ˆì•¡</b></td><td id="t_buy_net"></td><td id="t_sub_net" class="highlight"></td></tr>
        </tbody>
      </table>
    </div>

    <!-- ì¹´ë“œ ì‚¬ìš©ê¸ˆì•¡ ë³„ ë¹„êµ(í™”ë©´ ìœ ì§€) -->
    <div class="card">
      <h2>ì¹´ë“œ ì‚¬ìš©ê¸ˆì•¡ ë³„ ìµœì¢… í˜œíƒê°€ ë¹„êµ</h2>
      <div class="grid-2" style="margin-top:8px">
        <div>
          <div class="pill">ì›” 30ë§Œì›â†‘ (11,000ì› ìºì‹œë°±)</div>
          <table class="table">
            <tr><td>ì›” ë‚©ì…</td><td class="right" id="s30_monthly">-</td></tr>
            <tr><td>ì´ì•¡(ì²­êµ¬í• ì¸ ë°˜ì˜)</td><td class="right" id="s30_total">-</td></tr>
            <tr><td>í˜œíƒ ì ìš© í›„ ì‹¤ì§ˆê¸ˆì•¡</td><td class="right" id="s30_net"><b>-</b></td></tr>
          </table>
        </div>
        <div>
          <div class="pill">ì›” 70ë§Œì›â†‘ (15,000ì› ìºì‹œë°±)</div>
          <table class="table">
            <tr><td>ì›” ë‚©ì…</td><td class="right" id="s70_monthly">-</td></tr>
            <tr><td>ì´ì•¡(ì²­êµ¬í• ì¸ ë°˜ì˜)</td><td class="right" id="s70_total">-</td></tr>
            <tr><td>í˜œíƒ ì ìš© í›„ ì‹¤ì§ˆê¸ˆì•¡</td><td class="right" id="s70_net"><b>-</b></td></tr>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- ì¸ì‡„ìš© PDF ë ˆì´ì•„ì›ƒ -->
  <div id="printSummary" class="ps-wrap">
    <div class="ps-title">êµ¬ë… êµ¬ë§¤ ê²¬ì ì„œ</div>
    <div class="ps-sub">ê°€ì „ì œí’ˆ êµ¬ë… êµ¬ë§¤ ìƒë‹´ ê²¬ì  ìš”ì•½</div>

    <div class="ps-billto">
      <div><b>ê³ ê°ëª…</b> <span id="ps_billto_name">ê³ ê°ë‹˜</span></div>
      <div><b>ëª¨ë¸ëª…</b> <span id="ps_billto_model">-</span></div>
      <div><b>ìƒë‹´ì¼ì</b> <span id="ps_date"></span></div>
      <div><b>ë§¤ì¥</b> ë¡¯ë°í•˜ì´ë§ˆíŠ¸ ì‚¼ì²œí¬ì </div>
      <div><b>ì—°ë½ì²˜</b> 055-835-5533</div>
    </div>

    <div class="ps-kpis">
      <div class="ps-kpi">
        <h3>êµ¬ë… ì´ì•¡(ì‚¬ìš©ì¡°ê±´ ìºì‹œë°± ë°˜ì˜)</h3>
        <div class="num" id="ps_sub">-</div>
      </div>
      <div class="ps-kpi">
        <h3>ìµœì¢…ê¸ˆì•¡(ìºì‹œë°±+í˜œíƒí™˜ì‚°)</h3>
        <div class="num" id="ps_final">-</div>
      </div>
    </div>

    <table class="ps-table">
      <tr><th>í’ˆëª©</th><td id="ps_preset">-</td><th>êµ¬ë…ê¸°ê°„</th><td id="ps_months">-</td></tr>
      <tr><th>ì¼ë°˜ êµ¬ë§¤ ì´ì•¡</th><td id="ps_buy">-</td><th>êµ¬ë…êµ¬ë§¤ ìµœì´ˆ ê²°ì œ ê¸ˆì•¡</th><td id="ps_sub_firstgross">-</td></tr>
      <tr><th>í˜œíƒ í™˜ì‚°(ì—°ì¥ë³´ì¦/í´ë¦¬ë‹/ì†Œëª¨í’ˆ)</th><td id="ps_benefit" colspan="3">-</td></tr>
    </table>

    <div class="ps-note">
      <h3>ì¹´ë“œ ì‹¤ì  ì œì™¸ ì•ˆë‚´</h3>
      <ul>
        <li>ê¸ˆìœµì„œë¹„ìŠ¤(ë‹¨ê¸°Â·ì¥ê¸°ì¹´ë“œëŒ€ì¶œ), ì´ì, ì—°íšŒë¹„, ì˜¤í† ìºì‹œë°±</li>
        <li>ìƒí’ˆê¶Œë¥˜/í¬ì¸íŠ¸ì¶©ì „/ê¸°í”„íŠ¸ì¹´ë“œ êµ¬ë§¤(ìœ ê°€ì¦ê¶Œ êµ¬ë§¤), ê°ì¢… ìˆ˜ìˆ˜ë£Œ</li>
        <li><b>ì•„íŒŒíŠ¸ ê´€ë¦¬ë¹„</b>, êµ­ì„¸, 4ëŒ€ë³´í—˜, ì§€ë°©ì„¸</li>
        <li>í•˜ì´ë§ˆíŠ¸ ì¥ê¸°í• ë¶€ ë§¤ì¶œ(24/36/48/60ê°œì›” í• ë¶€ ë§¤ì¶œ)</li>
      </ul>
    </div>

    <div class="ps-meta">â€» ëª¨ë“  ê¸ˆì•¡ì€ ë¶€ê°€ì„¸ í¬í•¨ ê¸°ì¤€ì…ë‹ˆë‹¤.</div>
  </div>
</div>

<script>
  // ìˆ«ì í¬ë§· ìœ í‹¸
  const parseNum = (v)=> +String(v).replace(/[^\d]/g,'') || 0;
  const fmt      = (n)=> (isNaN(n)? "-" : n.toLocaleString('ko-KR')+"ì›");
  const fmtPlain = (n)=> n.toLocaleString('ko-KR');
  const monthsToYearsText = (m)=> `${m}ê°œì›” (= ${Math.round(m/12)}ë…„)`;

  // ì½¤ë§ˆ ìë™(blur ì‹œ)
  function attachComma(id){
    const el = document.getElementById(id);
    if(!el) return;
    el.addEventListener('blur', ()=>{ el.value = fmtPlain(parseNum(el.value)); calc(); });
    el.addEventListener('focus', ()=>{ el.select(); });
  }

  // ì—°ì¥ë³´ì¦ ìë™ í…Œì´ë¸”
  function calcWarrantyByBuyPrice(price){
    const tiers = [
      [150000,4000],[300000,6000],[500000,7000],[750000,10500],[1000000,14000],
      [1500000,21000],[2000000,28000],[2500000,35000],[3000000,42000],
      [3500000,49000],[4000000,56000],[10000000,70000],
    ];
    for(const [max,fee] of tiers){ if(price<=max) return fee; }
    return 70000;
  }

  function applyPreset(){
    const chosen = document.getElementById('preset').value;
    const valCleaning = document.getElementById('val_cleaning');
    const partsIncluded = document.getElementById('parts_included');
    const warn = document.getElementById('warn_none');

    if(chosen==='NONE'){
      if(valCleaning) valCleaning.value = fmtPlain(0);
      if(partsIncluded) partsIncluded.checked = false;
      if(warn) warn.style.display = "block";
    }else{
      const price = +chosen.split('|')[1];
      if(valCleaning) valCleaning.value = fmtPlain(price||0);
      if(warn) warn.style.display = "none";
    }
    calc();
  }

  function calc(){
    const buyPrice     = parseNum(document.getElementById('buy_price')?.value ?? 0);
    const subMonthly   = parseNum(document.getElementById('sub_monthly')?.value ?? 0);
    const months       = +document.getElementById('sub_months')?.value || 0;
    const cashback     = +document.getElementById('cashback_tier')?.value || 0;
    const cleaningCnt  = +document.getElementById('cleaning_count')?.value || 0;
    const valCleaning  = parseNum(document.getElementById('val_cleaning')?.value ?? 0);
    const partsIncluded= document.getElementById('parts_included')?.checked ?? false;
    const valParts     = parseNum(document.getElementById('val_parts')?.value ?? 0);
    const partsNote    = document.getElementById('parts_note')?.value || "";
    const preset       = document.getElementById('preset')?.value || "NONE";
    const benefitManual= parseNum(document.getElementById('benefit_manual')?.value ?? 0);

    // ì—°ì¥ë³´ì¦ ìë™(í¸ì§‘ ì¤‘ì´ë©´ ìœ ì§€)
    const autoWarranty = calcWarrantyByBuyPrice(buyPrice);
    const wEl = document.getElementById('val_warranty');
    if(wEl && document.activeElement!==wEl){ wEl.value = fmtPlain(autoWarranty); }
    const valWarranty = parseNum(wEl?.value ?? 0);

    // ìµœì´ˆê²°ì œ & ì²­êµ¬í• ì¸(5%<=50,000)
    const subGross = subMonthly * months;
    const initDisc = Math.min(Math.round(subGross * 0.05), 50000);

    // ìºì‹œë°± ë°˜ì˜ ì›”ë‚©ì…/í•©ê³„/ì´ì•¡
    const subMonthlyAfter = Math.max(subMonthly - cashback, 0);
    const subMonthlySum   = subMonthlyAfter * months;
    const subTotal        = subMonthlySum - initDisc;

    // í˜œíƒ í™˜ì‚°(ì„ íƒì—†ìŒì¼ ë•Œë§Œ ë³´ì¦ í¬í•¨)
    const cleaningTimes   = (preset==='NONE'?0:Math.max(cleaningCnt,0));
    const benefitCleaning = (preset==='NONE'?0:(valCleaning*cleaningTimes));
    const benefitParts    = (preset==='NONE'?0:(partsIncluded?valParts:0));
    const benefitWarranty = (preset==='NONE'?valWarranty:0);
    const benefitTotal    = benefitWarranty + benefitCleaning + benefitParts;

    // KPI & ìƒì„¸(í™”ë©´)
    const cbSelected      = cashback * months;
    const finalInclCB     = subGross - initDisc - benefitManual - cbSelected;
    const buyNet          = buyPrice - benefitManual;
    const subNet          = (subTotal - benefitTotal) - benefitManual;

    const set = (id, v)=>{ const el=document.getElementById(id); if(el) el.textContent=v; };
    set('kpi_buy', fmt(buyPrice));
    set('kpi_final_incl_cb', fmt(finalInclCB));
    set('kpi_sub_net', fmt(subNet));

    set('t_buy_price', fmt(buyPrice));
    set('t_sub_first', fmt(subGross));
    set('t_sub_monthly', fmt(subMonthlyAfter));
    set('t_sub_monthly_sum', fmt(subMonthlySum));
    set('t_sub_months', monthsToYearsText(months));
    set('t_sub_warranty', monthsToYearsText(months));
    const cleaningText = (preset==='NONE')?"ë¯¸í¬í•¨":`${cleaningTimes}íšŒ Ã— ${fmt(valCleaning)} = ${fmt(benefitCleaning)}`;
    const partsText    = (preset==='NONE')?"ë¯¸í¬í•¨":(partsIncluded?`í¬í•¨ (${partsNote||"ì†Œëª¨í’ˆ"}) Â· ${fmt(valParts)}`:"ë¯¸í¬í•¨");
    set('t_cleaning', cleaningText); set('t_parts', partsText);
    set('t_buy_total', fmt(buyPrice)); set('t_sub_total', fmt(subTotal));
    set('t_benefit_value', fmt(benefitTotal));
    set('t_benefit_manual_buy', "-"+fmt(benefitManual).replace("ì›","ì›"));
    set('t_benefit_manual_sub', "-"+fmt(benefitManual).replace("ì›","ì›"));
    set('t_buy_net', fmt(buyNet)); set('t_sub_net', fmt(subNet));

    // í™”ë©´ 30/70 ë¹„êµ
    const s30Monthly = Math.max(subMonthly - 11000, 0);
    const s70Monthly = Math.max(subMonthly - 15000, 0);
    const s30Total   = s30Monthly * months - initDisc;
    const s70Total   = s70Monthly * months - initDisc;
    const s30Net     = (s30Total - benefitTotal) - benefitManual;
    const s70Net     = (s70Total - benefitTotal) - benefitManual;
    set('s30_monthly', fmt(s30Monthly)); set('s70_monthly', fmt(s70Monthly));
    set('s30_total', fmt(s30Total));     set('s70_total', fmt(s70Total));
    set('s30_net', fmt(s30Net));         set('s70_net', fmt(s70Net));

    // PDF ê°’ ì£¼ì… (ë‹¨ì¼ ì‹œë‚˜ë¦¬ì˜¤)
    const presetText = document.getElementById('preset')?.selectedOptions[0]?.textContent || "-";
    set('ps_preset', presetText);
    set('ps_months', monthsToYearsText(months));
    set('ps_buy', fmt(buyPrice));
    set('ps_sub_firstgross', fmt(subGross));
    set('ps_sub', fmt(subTotal));
    set('ps_benefit', fmt(benefitTotal));
    set('ps_final', fmt(finalInclCB - benefitTotal));
  }

  // ê³ ê°/ëª¨ë¸ëª…ì€ PDF ë³¸ë¬¸ ë°•ìŠ¤ì—ë§Œ ë°˜ì˜
  function syncPrintMeta(){
    const rawName = document.getElementById('customer_name')?.value.trim() || "";
    const name = rawName ? (rawName + " ê³ ê°ë‹˜") : "ê³ ê°ë‹˜";
    const model = document.getElementById('model_name')?.value.trim() || "-";
    const d = new Date(); const pad = (n)=> String(n).padStart(2,"0");
    const dateTxt = `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}`;
    const set = (id, v)=>{ const el=document.getElementById(id); if(el) el.textContent=v; };
    set('ps_billto_name', name);
    set('ps_billto_model', model);
    set('ps_date', dateTxt);
  }

  // ì½¤ë§ˆ ìë™ ì ìš©
  ['buy_price','sub_monthly','val_cleaning','val_warranty','val_parts','benefit_manual'].forEach(attachComma);

  // ì´ë²¤íŠ¸
  document.getElementById('preset')?.addEventListener('change', applyPreset);
  ['customer_name','model_name','sub_months','cashback_tier','cleaning_count','parts_included','parts_note']
    .forEach(id => document.getElementById(id)?.addEventListener('input', ()=>{ syncPrintMeta(); calc(); }));
  ['buy_price','sub_monthly','val_cleaning','val_warranty','val_parts','benefit_manual']
    .forEach(id => document.getElementById(id)?.addEventListener('blur', ()=>{ syncPrintMeta(); calc(); }));

  window.addEventListener('load', ()=>{ syncPrintMeta(); applyPreset(); calc(); });
</script>
</body>
</html>
