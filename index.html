<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ì•ˆì‹¬CARE Â· êµ¬ë…/ì¼ë°˜ ê³„ì‚°ê¸° + í•´ì§€ ìœ„ì•½ê¸ˆ ê³„ì‚°ê¸°</title>
<style>
  :root{
    --brand:#c40000; --bg:#0a0f1e; --card:#0f172a; --line:#1f2a44; --pill:#0b1220; --text:#e7eefb; --muted:#9aa6c0;
    --radius:14px; --gap:12px; --hot:#9bff6a; --hotbg:#19321a; --hotshadow:#2aff9a55; --blue:#2a6aff; --red:#c40000;
  }
  *{box-sizing:border-box;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans KR",Arial,sans-serif}
  html{-webkit-text-size-adjust:100%}
  body{margin:0;background:var(--bg);color:var(--text)}
  .wrap{max-width:1100px;margin:0 auto;padding:18px}

  .brandbar{display:flex;gap:12px;margin-bottom:14px;padding:16px;border:1px solid var(--line);
    border-radius:var(--radius);background:linear-gradient(90deg,rgba(196,0,0,.12),rgba(196,0,0,0))}
  .logo img{width:56px;height:56px;border-radius:12px;object-fit:cover}
  .sub{color:var(--muted);font-size:12px;line-height:1.35}

  .card{background:var(--card);border:1px solid var(--line);border-radius:var(--radius);padding:16px;margin-bottom:14px}
  h1{margin:6px 0 10px;font-size:28px}
  h2{margin:4px 0 8px;font-size:18px}
  .muted{color:var(--muted);font-size:12px}
  .row{display:grid;grid-template-columns:1.2fr 1fr;gap:14px}
  .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:var(--gap)}
  .grid-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:var(--gap)}
  .kpi{display:flex;justify-content:space-between;align-items:center;gap:10px;padding:12px;background:var(--pill);border:1px solid var(--line);border-radius:12px}
  .highlight{color:#93f1cb;font-weight:800}
  .btn{padding:10px 14px;border-radius:12px;border:1px solid var(--line);background:rgba(196,0,0,.12);color:#ffd2d2;cursor:pointer}
  .btn.red{background:#311616;border-color:#5b1a1a;color:#ffdede}

  input,select{width:100%;padding:14px 12px;border-radius:12px;background:#0e1628;border:1px solid #223150;color:#e7eefb;
    outline:none;font-size:18px;line-height:1.2;font-variant-numeric:tabular-nums;caret-color:#7dff8b}
  input::placeholder{color:#6b7a98}
  input[type="checkbox"]{width:auto;transform:scale(1.15);margin-right:6px}
  select, option, optgroup{background:#0b1220;color:#e7eefb}
  optgroup{color:#aac1e6}
  #model_name{text-transform:uppercase;}

  /* ğŸ”§ ë ˆì´ë¸” ì¤„ë°”ê¿ˆ ê¹”ë”í•˜ê²Œ (ë°°ì§€ëŠ” ê³ ì •, í…ìŠ¤íŠ¸ë§Œ ì¤„ë°”ê¿ˆ) */
  .hot label{
    display:grid;
    grid-template-columns:auto 1fr;
    align-items:center;
    gap:6px;
    margin-bottom:6px;
    font-weight:800;
    word-break:keep-all;
  }
  .hot label .badge{
    color:#98f79e;font-size:12px;
    display:inline-flex;
    white-space:nowrap;
    margin-right:0;
  }
  .hot input,.hot select{background:linear-gradient(0deg,var(--hotbg),#0e1628);border:2px solid var(--hot);box-shadow:0 0 0 3px var(--hotshadow)}
  .hot input:focus,.hot select:focus{box-shadow:0 0 0 4px #7dffb855}

  table{width:100%;border-collapse:collapse}
  th,td{border-bottom:1px dashed var(--line);padding:10px 8px;text-align:left;font-size:14px}

  /* ----- 3ì¤„ ìš”ì•½(â‘ â‘¡â‘¢) ----- */
  #summary3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin:10px 0 6px}
  .pill{border:2px solid #e5e7eb33;background:#0e1628;border-radius:12px;padding:12px;display:flex;align-items:center;justify-content:space-between;gap:8px}
  .pill .num{font-size:13px;color:#9fb5ff}
  .pill b{font-size:18px}
  .cta{display:inline-flex;align-items:center;gap:10px;border:2px solid #2a3a5f;background:#0c1730;border-radius:14px;padding:12px 16px;margin:4px 0 12px;font-weight:900}
  .cta .price{font-size:22px}

  /* ì›” ì‹¤ì  ë°•ìŠ¤ */
  .spend-boxes{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  .spend{border:2px solid var(--red);background:linear-gradient(180deg,#220000,#0f172a);border-radius:14px;padding:14px}
  .spend h3{margin:0 0 6px;font-size:14px;color:#fff}
  .spend .big{font-size:28px;font-weight:900;color:#fff}
  .spend .desc{margin-top:6px;font-size:12px;color:#fff}

  /* ìƒì„¸ ë¹„êµ í…Œë‘ë¦¬ */
  #section-detail{border:2px solid var(--blue)}

  /* ===== ëª¨ë‹¬ ===== */
  .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.5);z-index:50}
  .modal.open{display:flex}
  .sheet{width:min(980px,96vw);max-height:92vh;overflow:auto;background:#0b1220;border:1px solid var(--line);border-radius:16px}
  .sheet header{position:sticky;top:0;background:#0f172a;border-bottom:1px solid var(--line);padding:12px 14px;display:flex;justify-content:space-between;align-items:center}
  .sheet .body{padding:16px}
  .inner-card{background:#0f172a;border:1px solid var(--line);border-radius:14px;padding:16px;margin-bottom:12px}
  .inner-grid-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px}
  .biggrid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  .bigbox{border:2px solid #e5e7eb33;border-radius:12px;background:#0e1628;padding:10px;color:#e7eefb}
  .bigbox h3{margin:0 0 6px;font-size:13px;color:#cbd5e1}
  .bigbox .num{font-size:26px;font-weight:900}
  .light-select, .light-select option, .light-select optgroup {background:#fff;color:#111;border:1px solid #223150}

  /* ===== ì¸ì‡„ ê¸°ë³¸ (ë„¤ê°€ ì¤€ ì›ë³¸ ê·¸ëŒ€ë¡œ ìœ ì§€) ===== */
  #printSummary{display:none}
  #penaltyPrintSheet{display:none !important} /* í™”ë©´ì—ì„œëŠ” í•­ìƒ ìˆ¨ê¹€ */

 @media print{
  @page{size:A4;margin:12mm}

  /* 1) í™”ë©´ ìš”ì†Œ ëŒ€ë¶€ë¶„ ìˆ¨ê¸°ê¸° */
  .brandbar,
  #penaltyModal,
  #printSummary,
  #penaltyPrintSheet { display:none !important; }

  /* #app ë‚´ë¶€ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ëª¨ë‘ ìˆ¨ê¹€ */
  #app > * { display:none !important; }

  /* 2) ë³´ì—¬ì¤„ 3ê°œ ì„¹ì…˜ë§Œ ë‹¤ì‹œ í‘œì‹œ */
  #summary3,
  #section-spend,
  #section-detail { display:block !important; }

  /* 3) í° ë°°ê²½/ê²€ì€ ê¸€ì(ê°€ë…ì„±â†‘) */
  body, body * {
    background:#fff !important;
    color:#000 !important;
    text-shadow:none !important;
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }

  /* 4) ì¹´ë“œÂ·í…Œì´ë¸” ì„ ëª…í•˜ê²Œ */
  #summary3 .pill,
  #section-spend .spend,
  #section-detail { background:#fff !important; border:2px solid #000 !important; }

  #section-detail table{
    width:100% !important;
    border-collapse:collapse !important;
    table-layout:fixed !important;
    background:#fff !important;
  }
  #section-detail thead th{
    background:#f4f6fa !important;
    color:#000 !important;
    font-weight:800 !important;
    border:1px solid #000 !important;
  }
  #section-detail th, #section-detail td{
    border:1px solid #000 !important;
    padding:8px 10px !important;
    font-size:13.5px !important;
    line-height:1.4;
  }
  /* ì§€ë¸Œë¼ ì¤„ë¬´ëŠ¬ë¡œ ì¤„ êµ¬ë¶„ */
  #section-detail tbody tr:nth-child(odd) td{ background:#fafcff !important; }
  #section-detail tbody tr:nth-child(even) td{ background:#fff !important; }

  /* 5) ìˆ«ì/ê°•ì¡° ë” êµµê²Œ */
  b, strong, .highlight { font-weight:900 !important; color:#000 !important; }

  /* 6) í˜ì´ì§€ ìª¼ê°œì§ ë°©ì§€ */
  #summary3, #section-spend, #section-detail { break-inside:avoid; }
  #section-spend { margin:8px 0 !important; }
}



    /* (PDF ëª¨ë“œ) ìš”ì•½ PDFë§Œ ì¸ì‡„ */
    body.print-pdf #printSummary{
      display:block !important; max-width:182mm !important; width:182mm !important;
      margin:0 auto !important; padding:4mm 4mm !important; box-sizing:border-box !important; overflow:visible !important;
    }
    body.print-pdf .brandbar{display:none!important}
    body.print-pdf #app{display:none!important}
    body.print-pdf .ps-table{table-layout:fixed !important;width:100% !important}
    body.print-pdf .ps-table th, body.print-pdf .ps-table td{word-wrap:break-word !important;overflow-wrap:break-word !important;white-space:normal !important}
    body.print-pdf .ps-title{font-size:24px !important}
    body.print-pdf .ps-kpi .num{font-size:20px !important}
    body.print-pdf .ps-table th, body.print-pdf .ps-table td{font-size:13.5px !important}

    /* (ê°„í¸ 1ì¥) ìœ„ì•½ê¸ˆ ìš”ì•½ ì¶œë ¥ */
    body.print-penalty-sheet #penaltyPrintSheet{
      display:block !important; width:190mm !important; margin:0 auto !important; background:#fff !important; color:#000 !important;
    }
    body.print-penalty-sheet .brandbar,
    body.print-penalty-sheet #app,
    body.print-penalty-sheet #printSummary,
    body.print-penalty-sheet #penaltyModal{display:none !important;}

    /* (ì„ íƒ) í˜„ì¬í™”ë©´ ì¸ì‡„ ëª¨ë“œ ë³´ì¥ìš© */
    body.print-screen #printSummary,
    body.print-screen #penaltyPrintSheet{display:none !important}
  }


  /* ===== ëª¨ë°”ì¼ ìµœì í™” (ìš”ì•½ ê³ ì • í•´ì œ + ì…ë ¥ í•­ìƒ í¼ì¹¨ + í‘œ ì¹´ë“œí˜•) ===== */
  @media (max-width: 880px){
    .wrap{padding:12px}
    h1{font-size:22px}
    h2{font-size:16px}

    .brandbar{padding:12px; gap:10px}
    .brandbar .muted{display:none}

    .row{grid-template-columns:1fr;gap:12px}
    .grid-3{grid-template-columns:1fr}   /* ëª¨ë°”ì¼ 1ì—´ */
    .grid-2{grid-template-columns:1fr}
    input,select{font-size:17px;padding:13px 12px}
    .kpi{padding:12px}
    th,td{font-size:13px;padding:8px 6px}
    .spend-boxes{grid-template-columns:1fr}
    .spend .big{font-size:24px}

    /* â‘ â‘¡â‘¢: ìƒë‹¨ ê³ ì • ì™„ì „ í•´ì œ + 1ì—´ */
    #summary3{
      position:static; top:auto;
      grid-template-columns:1fr;
      gap:8px; margin:6px 0 10px;
    }
    .pill{padding:10px 12px}

    /* ìƒì„¸í‘œ â†’ ì¹´ë“œí˜•(ëª¨ë°”ì¼ë§Œ) */
    #section-detail{padding:12px}
    #section-detail table thead{display:none}
    #section-detail table{border:0}
    #section-detail tbody tr{
      display:block;border:1px solid var(--line);background:#0e1628;border-radius:12px;
      padding:10px 12px;margin:0 0 10px 0;
    }
    #section-detail tbody td{display:block;border:0;padding:6px 0;font-size:14px}
    #section-detail tbody td:first-child{font-weight:900;color:#fff;margin-bottom:4px}
    #section-detail tbody td:nth-child(2)::before{content:"ì¼ë°˜ êµ¬ë§¤ Â· ";color:#9aa6c0;font-weight:700}
    #section-detail tbody td:nth-child(3)::before{content:"êµ¬ë… êµ¬ë§¤ Â· ";color:#9aa6c0;font-weight:700}
  }

  @media (max-width: 520px){
    .grid-3{grid-template-columns:1fr}
    input,select{font-size:16px}
    h1{font-size:20px}
  }
</style>
</head>
<body>
<div class="wrap" aria-live="polite">
  <!-- í—¤ë” -->
  <div class="brandbar">
    <div class="logo" aria-hidden="true">
      <img src="https://play-lh.googleusercontent.com/_uH9WIQdMGBGMoq-IXWmgvGD0AU72NSy3aTWA6FTPCGJwUcv9DRAQjf4HR83gPdvMjY" alt="HIMART">
    </div>
    <div>
      <div style="font-weight:900;font-size:22px;">ì•ˆì‹¬CARE</div>
      <div class="sub">
        Total home service clean &amp; warranty <br>Â· í•˜ì´ë§ˆíŠ¸ ì‚¼ì²œí¬ì <br> í™ˆì„œë¹„ìŠ¤ì„¼í„°<br>
        ì œì‘ : ì„œë¹„ìŠ¤ì„¼í„°ì¥
      </div>
    </div>
    <div style="margin-left:auto;display:flex;gap:12px;align-items:flex-start;flex-wrap:wrap">
      <div class="hot" style="min-width:240px">
        <label for="customer_name"><span class="badge">âœï¸ ì…ë ¥</span>ê³ ê°ëª…</label>
        <input id="customer_name" placeholder="ì˜ˆ) í™ê¸¸ë™" autocomplete="off" />
        <div class="muted">ì¸ì‡„ ì‹œ â€˜ê³ ê°ë‹˜â€™ ìë™ í‘œê¸°</div>
      </div>
      <div class="hot" style="min-width:240px">
        <label for="model_name"><span class="badge">âœï¸ ì…ë ¥</span>ëª¨ë¸ëª…</label>
        <input id="model_name" placeholder="ì˜ˆ) OBJ1234" autocomplete="off" />
        <div class="muted">í•­ìƒ ëŒ€ë¬¸ìë¡œ í‘œì‹œë©ë‹ˆë‹¤</div>
      </div>
      <div style="display:flex;gap:8px;flex-wrap:wrap">
        <button class="btn" id="btnPrintPdf" title="ìš”ì•½ PDF ì¸ì‡„">ìƒë‹´ìš© ìš”ì•½ PDF</button>
        <button class="btn" id="btnPrintScreen" title="í™”ë©´ ê·¸ëŒ€ë¡œ ì¸ì‡„">í™”ë©´ ê·¸ëŒ€ë¡œ ì¸ì‡„</button>
        <button class="btn red" id="btnPenaltyOpen">êµ¬ë… í•´ì§€ ìœ„ì•½ê¸ˆ ê³„ì‚°ê¸°</button>
      </div>
    </div>
  </div>

  <!-- ë³¸ë¬¸ -->
  <div id="app">
    <h1>ì¼ë°˜êµ¬ë§¤ / êµ¬ë…êµ¬ë§¤ ë¹„êµ</h1>

    <!-- â­ 3ì¤„ ìš”ì•½ (â‘  â‘¡ â‘¢) -->
    <div id="summary3" aria-label="3ì¤„ ìš”ì•½">
      <div class="pill"><span class="num">â‘  ì›” ë¶€ë‹´<br>(ìºì‹œë°± í¬í•¨ê°€)</span><b id="sum_monthly">-</b><span>/ì›”</span></div>
      <div class="pill"><span class="num">â‘¡ ë³´ì¦ê¸°ê°„<br>(ê¸°ë³¸1ë…„+ì—°ì¥ë³´ì¦ë³´í—˜)</span><b id="sum_warranty">-</b></div>
      <div class="pill"><span class="num">â‘¢ í¬í•¨ëœ ê´€ë¦¬ë¹„<br>(ë³´ì¦Â·ì²­ì†ŒÂ·ë¶€í’ˆ)</span><b id="sum_manage">-</b></div>
    </div>
   
    <div class="row">
      <!-- ì…ë ¥ì¹´ë“œ (í•­ìƒ í¼ì¹¨) -->
      <div class="card" aria-label="êµ¬ë… ì¡°ê±´ ì…ë ¥">
        <h2>êµ¬ë… ì¡°ê±´ ì„ íƒ</h2>

        <div class="grid-2" style="margin-top:6px">
          <div class="hot">
            <label for="buy_price"><span class="badge">âœï¸ ì…ë ¥</span>ì¼ë°˜ êµ¬ë§¤ê°€ (ì›)</label>
            <input id="buy_price" value="1,390,000" inputmode="numeric" autocomplete="off">
            <div class="muted">ë¬´ìƒ A/S ë³´ì¦ê¸°ê°„ì€ <b>ì œì¡°ì‚¬ê¸°ì¤€</b> </div>
          </div>
          <div class="hot">
            <label for="sub_monthly"><span class="badge">âœï¸ ì…ë ¥</span>êµ¬ë… ì›”ìš”ê¸ˆ (ì›)</label>
            <input id="sub_monthly" value="52,300" inputmode="numeric" autocomplete="off">
            <div class="muted"><b>5% (ìµœëŒ€ 50,000ì›)</b> ì²­êµ¬í• ì¸ ìë™ ë°˜ì˜</div>
          </div>
        </div>

        <div class="grid-3" style="margin-top:12px">
          <div class="hot">
            <label for="sub_months"><span class="badge">âœï¸ ì…ë ¥</span>êµ¬ë…ê¸°ê°„= A/S ë³´ì¦</label>
            <select id="sub_months">
              <option value="36" selected>36ê°œì›” (3ë…„)</option>
              <option value="60">60ê°œì›” (5ë…„)</option>
            </select>
          </div>
          <div class="hot">
            <label for="cashback_tier"><span class="badge">âœï¸ì…ë ¥</span>ì‚¬ìš©ê¸ˆì•¡ë³„ ìºì‹œë°±</label>
            <select id="cashback_tier">
              <option value="0">ì—†ìŒ</option>
              <option value="11000" selected>ì›” 30ë§Œì›â†‘ (11,000)</option>
              <option value="15000">ì›” 70ë§Œì›â†‘ (15,000)</option>
            </select>
          </div>
          <div class="hot">
            <label for="preset"><span class="badge">âœï¸ ì…ë ¥</span>êµ¬ë…í’ˆëª©</label>
            <select id="preset">
              <option value="NONE">ì„ íƒ ì—†ìŒ (ì—°ì¥ë³´ì¦ë§Œ)</option>
              <optgroup label="ì—ì–´ì»¨">
                <option value="SET-CLEAN-PAC|156000">ìŠ¤íƒ ë“œ (156,000)</option>
                <option value="SET-CLEAN-RAC|101000">ë²½ê±¸ì´ (101,000)</option>
                <option value="SET-CLEAN-2IN1|252000">2IN1 (252,000)</option>
                <option value="SET-CLEAN-3IN1|338000">3IN1 (338,000)</option>
              </optgroup>
              <optgroup label="ì„¸íƒê¸°">
                <option value="SET-CLEAN-WM|106000">ì¼ë°˜ (106,000)</option>
                <option value="SET-CLEAN-WM(DRUM)|170000">ë“œëŸ¼(ì¼ë°˜) (170,000)</option>
              </optgroup>
              <optgroup label="ê±´ì¡°ê¸°/ì˜ë¥˜ê´€ë¦¬ê¸°">
                <option value="SET-CLEAN-DRYER(NEW)|92000">ê±´ì¡°ê¸° ì „ëª¨ë¸ (92,000)</option>
                <option value="SET-CLEAN-STEAMCLOSET|68000">ì˜ë¥˜ê´€ë¦¬ê¸° ì „ëª¨ë¸ (68,000)</option>
              </optgroup>
              <optgroup label="ëƒ‰ì¥ê³ ">
                <option value="SET-CLEAN-REF|126000">ë‹¨ë¬¸í˜• (126,000)</option>
                <option value="SET-CLEAN-SBS|164000">ì–‘ë¬¸í˜• (164,000)</option>
              </optgroup>
              <optgroup label="ê¹€ëƒ‰">
                <option value="SET-CLEAN-KREF(UPDOOR)|99000">ëšœê»‘ì‹ (99,000)</option>
                <option value="SET-CLEAN-KREF(STAND)|121000">ìŠ¤íƒ ë“œ (121,000)</option>
                <option value="SET-CLEAN-KREF(4DOOR)|170000">4ë„ì–´ (170,000)</option>
              </optgroup>
              <optgroup label="ì‹ê¸°ì„¸ì²™ê¸°">
                <option value="SET-CLEAN-DW|84000">ì „ëª¨ë¸ (84,000)</option>
              </optgroup>
            </select>
            <div class="muted">í•´ë‹¹í’ˆëª©ì„ ì„ íƒí•˜ì„¸ìš”</div>
          </div>
        </div>

        <div class="grid-3" style="margin-top:12px">
          <div>
            <label for="val_cleaning">í´ë¦¬ë‹ 1íšŒ ë¹„ìš©(ì›)</label>
            <input id="val_cleaning" value="0" inputmode="numeric" autocomplete="off">
            <div class="muted">í’ˆëª© ì„ íƒ ì‹œ ìë™ ë³€ê²½</div>
          </div>
          <div class="hot">
            <label for="cleaning_count"><span class="badge">âœï¸ ì…ë ¥</span>í´ë¦¬ë‹ íšŸìˆ˜</label>
            <select id="cleaning_count">
              <option value="1" selected>ìµœì†Œ 1íšŒ</option><option value="2">2íšŒ</option><option value="3">3íšŒ</option>
            </select>
          </div>
          <div>
            <label for="val_warranty">ì—°ì¥ë³´ì¦ í™˜ì‚°ê°€</label>
            <input id="val_warranty" value="50,000" inputmode="numeric" autocomplete="off">
            <div class="muted">ê¸ˆì•¡ë³„ ì—°ì¥ë³´ì¦ë³´í—˜ê°€</div>
          </div>
        </div>

        <div class="grid-3" style="margin-top:12px">
          <div class="hot">
            <label for="val_parts"><span class="badge">âœï¸ ì…ë ¥</span>ë¶€í’ˆ/ì†Œëª¨í’ˆ í™˜ì‚°ê°€(ì›)</label>
            <input id="val_parts" value="0" inputmode="numeric" placeholder="ì˜ˆ: 250,000" autocomplete="off">
          </div>
          <div class="hot">
            <label for="parts_included"><span class="badge">âœï¸ ì…ë ¥</span>ë¶€í’ˆ/ì†Œëª¨í’ˆ í¬í•¨ ì—¬ë¶€ (êµ¬ë…)</label>
            <div><input type="checkbox" id="parts_included"><span class="muted">ì²´í¬ ì‹œ í˜œíƒì— ë°˜ì˜</span></div>
          </div>
          <div class="hot">
            <label for="parts_note"><span class="badge">âœï¸ ì…ë ¥</span>ë¶€í’ˆ/ì†Œëª¨í’ˆ ë¹„ê³ </label>
            <input id="parts_note" placeholder="ì˜ˆ: ë°°í„°ë¦¬ êµì²´ 1íšŒ" autocomplete="off">
          </div>
        </div>

        <div class="grid-2" style="margin-top:12px">
          <div class="hot">
            <label for="benefit_manual"><span class="badge">âœï¸ ì…ë ¥</span>ì œí’ˆ êµ¬ë§¤ í˜œíƒ â†’ í¬ì¸íŠ¸/ìºì‹œë°± ë“± (ì›)</label>
            <input id="benefit_manual" value="0" inputmode="numeric" placeholder="ì˜ˆ: 30,000" autocomplete="off">
            <div class="muted">ì¼ë°˜/êµ¬ë… ë™ì¼ ì°¨ê° (ë¶€ê°€ì„¸ í¬í•¨)</div>
          </div>
        </div>
      </div>

      <!-- KPI -->
      <div class="card" aria-label="ìš”ì•½ KPI">
        <h2>í˜œíƒê°€ ìµœì¢… ë¹„êµğŸ‘“</h2>
        <div class="kpi" style="margin-top:8px"><span>ì¼ë°˜ êµ¬ë§¤ ì´ì•¡</span><strong id="kpi_buy">-</strong></div>
        <div class="kpi"><span>ì´ ì†Œìœ ë¹„ìš©<br>(ì‚¬ìš©ê¸ˆì•¡ë³„ ìºì‹œë°± í¬í•¨)</span><strong id="kpi_final_incl_cb" class="highlight">-</strong></div>
        <div class="kpi"><span>ì¼€ì–´ë¹„ìš© í•©ì‚° ìµœì¢…í˜œíƒê°€</span><strong id="kpi_sub_net" class="highlight">-</strong></div>
        <p class="muted" style="margin-top:10px">ìµœì¢…í˜œíƒê°€ = (ìˆœ ë‚©ì… ì›”ìš”ê¸ˆ-ìºì‹œë°±)Ã—ê¸°ê°„ âˆ’ <b>ì²­êµ¬í• ì¸(5%, ìµœëŒ€ 50,000)</b> âˆ’ (ì—°ì¥ë³´ì¦+í´ë¦¬ë‹+ì†Œëª¨í’ˆ) âˆ’ ì œí’ˆêµ¬ë§¤í˜œíƒ</p>
        <br><br>
        <h2>êµ¬ë…í•˜ë©´ ì¢‹ì€ì </h2>
        <div class="kpi" style="margin-top:8px"><span>ğŸ”§<b>ë¶ˆí™•ì‹¤í•œ ê³ ì¥ì— ëŒ€í•œ ê±±ì •ì—†ì´ êµ¬ë§¤</b></span></div>
        <div class="kpi" style="margin-top:8px"><span>âœ…<b>ì§ì ‘ê´€ë¦¬ê°€ ì–´ë ¤ìš´ ê°€ì „ì œí’ˆâ†’ì „ë¬¸ê°€ ì¼€ì–´</b></span></div>
        <div class="kpi" style="margin-top:8px"><span>ğŸ§¹<b>ë§¤ë…„ ì˜¤ë¥´ëŠ” í´ë¦¬ë‹ë¹„ìš©â†’ ê°€ê²©ìƒìŠ¹ì—†ì´</b></span></div>
        <div class="kpi" style="margin-top:8px"><span>ğŸ’¸<b>ëª©ëˆ ì§€ì¶œì—†ì´ ìê¸ˆìš´ìš© ê°€ëŠ¥â†’ì›”ë¶„ë‚©</b></span></div>
      </div>
    </div>

    <!-- ì›” ì‹¤ì  ë°•ìŠ¤ -->
    <div class="card" id="section-spend">
      <h2>ì›” ì‚¬ìš© ì‹¤ì ë³„ ì˜ˆìƒ ë¶€ë‹´(ìºì‹œë°± ì ìš©)</h2>
      <div class="spend-boxes">
        <div class="spend">
          <h3>ì›” 30ë§Œì› ì‚¬ìš© ì‹œ (ìºì‹œë°± 11,000)</h3>
          <div class="big" id="spend_300">-</div>
          <div class="desc">í˜„ì¬ ì›”ìš”ê¸ˆì—ì„œ 11,000ì› ìºì‹œë°±(ì…ê¸ˆ) ë’¤ì˜ ì›” ë¶€ë‹´</div>
        </div>
        <div class="spend">
          <h3>ì›” 70ë§Œì› ì‚¬ìš© ì‹œ (ìºì‹œë°± 15,000)</h3>
          <div class="big" id="spend_700">-</div>
          <div class="desc">í˜„ì¬ ì›”ìš”ê¸ˆì—ì„œ 15,000ì› ìºì‹œë°±(ì…ê¸ˆ) ë’¤ì˜ ì›” ë¶€ë‹´</div>
        </div>
      </div>
    </div>

    <!-- ìƒì„¸ í˜œíƒ ë¹„êµ -->
    <div class="card" id="section-detail">
      <h2>ìƒì„¸ í˜œíƒ ë¹„êµ</h2>
      <table role="table" aria-label="ìƒì„¸ ë¹„êµí‘œ">
        <thead><tr><th>í•­ëª©</th><th>ì¼ë°˜ êµ¬ë§¤</th><th>êµ¬ë… êµ¬ë§¤</th></tr></thead>
        <tbody>
          <tr><td>êµ¬ë…êµ¬ë§¤ ìµœì´ˆê²°ì œ</td><td id="t_buy_price"></td><td id="t_sub_first"></td></tr>
          <tr><td>ì›” ë‚©ì…(ìºì‹œë°± ë°˜ì˜)</td><td class="muted">í•´ë‹¹ ì—†ìŒ</td><td id="t_sub_monthly"></td></tr>
          <tr><td>ì›” ë‚©ì… í•©ê³„</td><td class="muted">í•´ë‹¹ ì—†ìŒ</td><td id="t_sub_monthly_sum"></td></tr>
          <tr><td>ì´ ê¸°ê°„</td><td>ì¼ì‹œë¶ˆ/ì¹´ë“œì‚¬ ë‹¨ê¸°í• ë¶€</td><td id="t_sub_months"></td></tr>
          <tr><td>ë¬´ìƒ A/S ë³´ì¦</td><td><b>1ë…„</b> (ê³ ì •)</td><td id="t_sub_warranty"></td></tr>
          <tr><td>í´ë¦¬ë‹</td><td><span class="muted">ë³„ë„êµ¬ë§¤</span></td><td id="t_cleaning"></td></tr>
          <tr><td>ë¶€í’ˆ/ì†Œëª¨í’ˆ</td><td><span class="muted">ë³„ë„êµ¬ë§¤</span></td><td id="t_parts"></td></tr>
          <tr><td>ì´ì•¡(ì²­êµ¬í• ì¸ ë°˜ì˜)</td><td id="t_buy_total"></td><td id="t_sub_total"></td></tr>
          <tr><td>í¬í•¨ëœ ê´€ë¦¬ë¹„(ë³´ì¦Â·ì²­ì†ŒÂ·ë¶€í’ˆ)</td><td class="muted">-</td><td id="t_benefit_value"></td></tr>
          <tr><td><b>í˜œíƒ ì ìš© í›„ ì‹¤ì§ˆê¸ˆì•¡</b></td><td id="t_buy_net"></td><td id="t_sub_net" class="highlight"></td></tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- PDF ì „ìš© (ìš”ì•½) -->
<div id="printSummary" class="ps-wrap">
  <div class="ps-title" style="font-size:26px;font-weight:900;margin:0 0 6px">êµ¬ë… êµ¬ë§¤ ê²¬ì ì„œ</div>
  <div class="ps-sub" style="font-size:14px;color:#333;margin-bottom:8px">ê°€ì „ì œí’ˆ êµ¬ë… êµ¬ë§¤ ìƒë‹´ ê²¬ì  ìš”ì•½</div>

  <div class="ps-bill" style="display:grid;grid-template-columns:1fr 1fr;gap:8px;border:2px solid #111;border-radius:10px;padding:10px;margin:8px 0">
    <div><b>ê³ ê°ëª…</b> <span id="ps_name">ê³ ê°ë‹˜</span></div>
    <div><b>ëª¨ë¸ëª…</b> <span id="ps_model">-</span></div>
    <div><b>ìƒë‹´ì¼ì</b> <span id="ps_date"></span></div>
    <div><b>ë§¤ì¥</b> ë¡¯ë°í•˜ì´ë§ˆíŠ¸ ì‚¼ì²œí¬ì </div>
    <div><b>ì—°ë½ì²˜</b> 055-835-5533</div>
  </div>

  <div class="ps-grid" style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin:6px 0 10px">
    <div class="ps-kpi" style="border:2px solid #111;border-radius:10px;padding:12px"><h3 style="margin:0 0 6px 0;font-size:15px">êµ¬ë… ì´ì•¡(ì‚¬ìš©ì¡°ê±´ ìºì‹œë°± ë°˜ì˜)</h3><div class="num" id="ps_sub_total" style="font-size:22px;font-weight:900">-</div></div>
    <div class="ps-kpi" style="border:2px solid #111;border-radius:10px;padding:12px"><h3 style="margin:0 0 6px 0;font-size:15px">ìµœì¢…ê¸ˆì•¡(ìºì‹œë°±+ê´€ë¦¬ë¹„ í™˜ì‚°)</h3><div class="num" id="ps_final" style="font-size:22px;font-weight:900">-</div></div>
  </div>

  <div class="ps-spend" style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin:6px 0 10px">
    <div class="ps-kpi" style="border:2px solid #111;border-radius:10px;padding:12px"><h3 style="margin:0 0 6px 0;font-size:15px">ì›” 30ë§Œì› ì‚¬ìš© ì‹œ</h3><div class="num" id="ps_spend_300" style="font-size:22px;font-weight:900">-</div><div class="muted" style="font-size:12px;color:#555;margin-top:4px">ìºì‹œë°± 11,000 ì ìš©</div></div>
    <div class="ps-kpi" style="border:2px solid #111;border-radius:10px;padding:12px"><h3 style="margin:0 0 6px 0;font-size:15px">ì›” 70ë§Œì› ì‚¬ìš© ì‹œ</h3><div class="num" id="ps_spend_700" style="font-size:22px;font-weight:900">-</div><div class="muted" style="font-size:12px;color:#555;margin-top:4px">ìºì‹œë°± 15,000 ì ìš©</div></div>
  </div>

  <table class="ps-table" style="width:100%;border-collapse:collapse;margin-top:6px">
    <tr><th style="border:1.8px solid #111;padding:8px 10px;background:#f3f6fb">í•­ëª©</th><th style="border:1.8px solid #111;padding:8px 10px;background:#f3f6fb">ì¼ë°˜ êµ¬ë§¤</th><th style="border:1.8px solid #111;padding:8px 10px;background:#f3f6fb">êµ¬ë… êµ¬ë§¤</th></tr>
    <tr><td style="border:1.8px solid #111;padding:8px 10px">ì¼ë°˜êµ¬ë§¤ ê¸ˆì•¡ / êµ¬ë… ìµœì´ˆ ê²°ì œê¸ˆì•¡</td><td id="ps_buy_total" style="border:1.8px solid #111;padding:8px 10px">-</td><td id="ps_sub_first" style="border:1.8px solid #111;padding:8px 10px">-</td></tr>
    <tr><td style="border:1.8px solid #111;padding:8px 10px">ì›”ë‚©ì…(ìºì‹œë°±ë°˜ì˜) / ì´ í•©ê³„</td><td style="border:1.8px solid #111;padding:8px 10px">í•´ë‹¹ ì—†ìŒ</td><td style="border:1.8px solid #111;padding:8px 10px"><span id="ps_sub_monthly">-</span><br><span id="ps_sub_monthly_sum">-</span></td></tr>
    <tr><td style="border:1.8px solid #111;padding:8px 10px">êµ¬ë…ê¸°ê°„ / ë¬´ìƒ A/Së³´ì¦ë³´í—˜</td><td style="border:1.8px solid #111;padding:8px 10px">ì¼ì‹œë¶ˆ/ë‹¨ê¸°í• ë¶€ Â· 1ë…„</td><td style="border:1.8px solid #111;padding:8px 10px"><span id="ps_months">-</span><br><span id="ps_warranty">-</span></td></tr>
    <tr><td style="border:1.8px solid #111;padding:8px 10px">í´ë¦¬ë‹ / ë¶€í’ˆÂ·ì†Œëª¨í’ˆ</td><td style="border:1.8px solid #111;padding:8px 10px">ë³„ë„êµ¬ë§¤ Â· ë³„ë„êµ¬ë§¤</td><td style="border:1.8px solid #111;padding:8px 10px"><span id="ps_cleaning">-</span><br><span id="ps_parts">-</span></td></tr>
    <tr><td style="border:1.8px solid #111;padding:8px 10px">í¬í•¨ëœ ê´€ë¦¬ë¹„(ë³´ì¦Â·ì²­ì†ŒÂ·ë¶€í’ˆ)</td><td style="border:1.8px solid #111;padding:8px 10px">-</td><td id="ps_benefit" style="border:1.8px solid #111;padding:8px 10px">-</td></tr>
    <tr><td style="border:1.8px solid #111;padding:8px 10px"><b>í˜œíƒ ì ìš© í›„ ì‹¤ì§ˆê¸ˆì•¡</b></td><td id="ps_buy_net" style="border:1.8px solid #111;padding:8px 10px">-</td><td id="ps_sub_net" style="border:1.8px solid #111;padding:8px 10px"><b>-</b></td></tr>
  </table>

  <div class="ps-note" style="border:2px solid #b91c1c;border-radius:10px;background:#fff5f5;padding:10px;margin-top:10px">
    <h3 style="margin:0 0 6px 0;color:#b91c1c;font-size:15px">ì¹´ë“œ ì‹¤ì  ì œì™¸ ì•ˆë‚´</h3>
    <ul style="margin:6px 0 0 18px">
      <li>ê¸ˆìœµì„œë¹„ìŠ¤(ë‹¨ê¸°Â·ì¥ê¸°ì¹´ë“œëŒ€ì¶œ), ì´ì, ì—°íšŒë¹„, ì˜¤í† ìºì‹œë°±</li>
      <li>ìƒí’ˆê¶Œë¥˜/í¬ì¸íŠ¸ì¶©ì „/ê¸°í”„íŠ¸ì¹´ë“œ êµ¬ë§¤(ìœ ê°€ì¦ê¶Œ êµ¬ë§¤), ê°ì¢… ìˆ˜ìˆ˜ë£Œ</li>
      <li><b>ì•„íŒŒíŠ¸ ê´€ë¦¬ë¹„</b>, êµ­ì„¸, 4ëŒ€ë³´í—˜, ì§€ë°©ì„¸</li>
      <li>í•˜ì´ë§ˆíŠ¸ ì¥ê¸°í• ë¶€ ë§¤ì¶œ(24/36/48/60ê°œì›” í• ë¶€ ë§¤ì¶œ)</li>
    </ul>
  </div>
  <div class="ps-meta" style="margin-top:6px;font-size:12px">â€» ëª¨ë“  ê¸ˆì•¡ì€ ë¶€ê°€ì„¸ í¬í•¨ ê¸°ì¤€ì…ë‹ˆë‹¤.</div>
</div>

<!-- ===== ëª¨ë‹¬ : êµ¬ë… í•´ì§€ ìœ„ì•½ê¸ˆ ê³„ì‚°ê¸° ===== -->
<div class="modal" id="penaltyModal" aria-hidden="true">
  <div class="sheet" role="dialog" aria-modal="true">
    <header>
      <strong>êµ¬ë… í•´ì§€ ìœ„ì•½ê¸ˆ ê³„ì‚°ê¸°</strong>
      <div style="display:flex;gap:8px">
        <button class="btn" id="btnPenaltyQuickPrint">ê°„í¸ ì¶œë ¥(1ì¥)</button>
        <button class="btn red" id="btnPenaltyClose">ë‹«ê¸° âœ•</button>
      </div>
    </header>
    <div class="body">
      <div class="inner-card"><div class="muted">ê¸°ì¤€: ê³ ê° ì„ì˜ í•´ì§€ ì‹œ Â· <b>ìˆœì›”ìš”ê¸ˆ = ì¹´ë“œ ì‹¤ì ê³¼ ë¬´ê´€í•œ â€˜ê¸°ë³¸ ë‚©ì…ê¸ˆ(ì›” ìš”ê¸ˆ ì›ê¸ˆ)â€™</b> ê¸°ì¤€</div></div>

      <div class="inner-card">
        <h3 style="margin:0 0 10px">ì…ë ¥</h3>
        <div class="inner-grid-3">
          <div>
            <label>ê³„ì•½ê¸°ê°„</label>
            <select id="contract_months" class="light-select">
              <option value="36" selected>36ê°œì›” (3ë…„)</option>
              <option value="60">60ê°œì›” (5ë…„)</option>
            </select>
          </div>
          <div>
            <label>ì›” ìš”ê¸ˆ (ì›)</label>
            <input id="monthly_fee" value="52,300" inputmode="numeric">
          </div>
          <div>
            <label>íšŒìˆ˜ í’ˆëª©</label>
            <select id="pickup_item" class="light-select">
              <option value="0" selected>ì„ íƒ ì—†ìŒ</option>
              <optgroup label="ë°ì´í„° í™•ì •">
                <option value="1100000">TV 90ì¸ì¹˜ ì´ìƒ (1,100,000)</option>
                <option value="266000">TV 80~89ì¸ì¹˜ (266,000)</option>
                <option value="169000">TV 79ì¸ì¹˜ ì´í•˜ (169,000)</option>
                <option value="159000">ëƒ‰ì¥ê³  (159,000)</option>
                <option value="129000">ê¹€ì¹˜ëƒ‰ì¥ê³  (129,000)</option>
                <option value="129000">ë“œëŸ¼/ì¼ë°˜ (129,000)</option>
                <option value="129000">ê±´ì¡°ê¸° (129,000)</option>
                <option value="219000">ì„¸íƒê¸°+ê±´ì¡°ê¸° (219,000)</option>
                <option value="187000">ì„¸íƒê¸° ì½¤ë³´ (187,000)</option>
                <option value="352000">2in1 ì—ì–´ì»¨ (352,000)</option>
                <option value="241000">ìŠ¤íƒ ë“œ ì—ì–´ì»¨ (241,000)</option>
                <option value="181000">ë²½ê±¸ì´ ì—ì–´ì»¨ (181,000)</option>
                <option value="181000">ì´ë™ì‹ ì°½ë¬¸í˜• (181,000)</option>
                <option value="60000">íƒœë¸”ë¦¿ (60,000)</option>
                <option value="87000">ë…¸íŠ¸ë¶ (87,000)</option>
                <option value="139000">ìŒì‹ë¬¼ ì²˜ë¦¬ê¸°(ì„¤ì¹˜í˜•) (139,000)</option>
                <option value="165000">ë¡œë´‡ì²­ì†Œê¸° (165,000)</option>
                <option value="109000">ê±´íƒ€ì… ì²­ì†Œê¸° (109,000)</option>
                <option value="139000">ì‹ê¸°ì„¸ì²™ê¸° (139,000)</option>
                <option value="152000">ì „ê¸°ë ˆì¸ì§€ (152,000)</option>
                <option value="97000">ê³µê¸°ì²­ì •ê¸° (97,000)</option>
                <option value="159000">ì•ˆë§ˆì˜ì (159,000)</option>
                <option value="97000">ë³µí•©ì˜¤ë¸ (97,000)</option>
                <option value="60000">í—¤ì–´ê¸°ê¸° (60,000)</option>
                <option value="123000">ì˜ë¥˜ê´€ë¦¬ê¸° (123,000)</option>
                <option value="139000">ë ˆì¸ì§€ í›„ë“œ (139,000)</option>
                <option value="97000">ì œìŠµê¸° (97,000)</option>
                <option value="89000">ì¹´ë©”ë¼ (89,000)</option>
                <option value="60000">ì „ê¸°ë©´ë„ê¸° (60,000)</option>
                <option value="109000">ì»¤í”¼ë¨¸ì‹  (109,000)</option>
                <option value="109000">ë¹„ë° (109,000)</option>
                <option value="97000">ì „ê¸°ë°¥ì†¥ (97,000)</option>
              </optgroup>
            </select>
          </div>
        </div>

        <div class="inner-grid-3" style="margin-top:12px">
          <div>
            <label>ì‚¬ìš© ê°œì›”ìˆ˜</label>
            <input id="used_months" value="12" inputmode="numeric">
          </div>
          <div>
            <label>íšŒìˆ˜ë¹„ (ì›)</label>
            <input id="pickup_fee" value="0" inputmode="numeric" readonly>
            <div class="muted" id="pickup_hint">íšŒìˆ˜ í’ˆëª©ì„ ì„ íƒí•˜ë©´ ìë™ ì…ë ¥ë©ë‹ˆë‹¤.</div>
          </div>
          <div>
            <label>ë¹„ê³ </label>
            <input id="memo" placeholder="ì˜ˆ: ë°©ë¬¸íšŒìˆ˜ í•„ìš”">
          </div>
        </div>

        <div class="biggrid" style="margin-top:10px">
          <div class="bigbox">
            <h3>ìˆœì›”ìš”ê¸ˆ(ê¸°ë³¸ ë‚©ì…ê¸ˆ)</h3>
            <div class="num" id="net_monthly">-</div>
          </div>
          <div class="bigbox">
            <h3>ì”ì—¬ ê°œì›” / ì”ì—¬ ì´ìš”ê¸ˆ</h3>
            <div class="num" id="remain_total">-</div>
          </div>
        </div>
        <p class="muted" style="margin:6px 0 0">ìœ„ì•½ê¸ˆìœ¨: â‰¤12ê°œì›” <b>30%</b> Â· 13~24ê°œì›” <b>20%</b> Â· 25ê°œì›”~ì¢…ë£Œ ì „ <b>10%</b> Â· ì¢…ë£Œ <b>0%</b></p>
      </div>

      <div class="inner-card">
        <h3 style="margin:0 0 10px">ê²°ê³¼</h3>
        <div class="kpi"><span>ì ìš© ìœ„ì•½ê¸ˆìœ¨</span><span id="rate_text" style="font-weight:900">-</span></div>
        <div class="kpi"><span>ìœ„ì•½ê¸ˆ(ì”ì—¬ì´ìš”ê¸ˆ Ã— ìœ„ì•½ê¸ˆìœ¨)</span><span id="penalty" style="font-weight:900">-</span></div>
        <div class="kpi"><span>íšŒìˆ˜ë¹„</span><span id="pickup" style="font-weight:900">-</span></div>
        <div class="kpi" style="border:2px solid #e5e7eb">
          <span><b>ìµœì¢… ì²­êµ¬ ê¸ˆì•¡</b></span>
          <span id="total_due" style="font-size:22px;font-weight:900">-</span>
        </div>

        <div class="inner-card" style="background:#0b1220;margin-top:12px">
          <h4 style="margin:0 0 6px">ìƒì„¸</h4>
          <table>
            <tr><td>ê³„ì•½ê¸°ê°„</td><td id="out_contract"></td></tr>
            <tr><td>ì‚¬ìš©ê°œì›” / ì”ì—¬ê°œì›”</td><td id="out_months"></td></tr>
            <tr><td>ì›”ìš”ê¸ˆ / ìˆœì›”ìš”ê¸ˆ</td><td id="out_monthlies"></td></tr>
            <tr><td>ì”ì—¬ ì´ìš”ê¸ˆ(ìˆœì›”ìš”ê¸ˆÃ—ì”ì—¬ê°œì›”)</td><td id="out_remain_sum"></td></tr>
            <tr><td>ë¹„ê³ </td><td id="out_memo">-</td></tr>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ===== ìœ„ì•½ê¸ˆ 'ê°„í¸ 1ì¥' ì¸ì‡„ ì‹œíŠ¸ ===== -->
<div id="penaltyPrintSheet" aria-hidden="true">
  <div class="head">
    <h1>êµ¬ë… í•´ì§€ ìœ„ì•½ê¸ˆ ìš”ì•½</h1>
    <div class="meta"><span id="pp_date"></span></div>
  </div>
  <div class="grid">
    <div class="box">
      <h3>ìš”ì•½ ì •ë³´</h3>
      <div class="kv"><span>ì›” ë‚©ì…ê¸ˆ(ìºì‹œë°± ì ìš© ì „)</span><b id="pp_monthly">-</b></div>
      <div class="kv"><span>ì‚¬ìš© ê¸°ê°„</span><b id="pp_used">-</b></div>
      <div class="kv"><span>ë‚¨ì€ ê¸°ê°„</span><b id="pp_remain">-</b></div>
      <div class="kv"><span>í•´ë‹¹ í’ˆëª©</span><b id="pp_item">-</b></div>
      <div class="kv"><span>íšŒìˆ˜ë¹„</span><b id="pp_pickup">-</b></div>
    </div>
    <div class="box">
      <h3>ìœ„ì•½ê¸ˆ</h3>
      <div class="kv"><span>ì‚°ì • ê¸°ì¤€</span><b id="pp_basis">-</b></div>
      <div class="kv"><span>ì”ì—¬ ì´ìš”ê¸ˆ(ê¸°ë³¸ ë‚©ì…ê¸ˆ Ã— ì”ì—¬ê°œì›”)</span><b id="pp_remain_total">-</b></div>
      <div class="total"><span>ì˜ˆìƒ ìœ„ì•½ê¸ˆ</span><span id="pp_penalty">-</span></div>
    </div>
  </div>
  <div class="box" style="margin-top:8px">
    <h3>í•´ì§€ ìˆœì„œ</h3>
    <ol>
      <li>í•´ì§€ ì•Œë¦¼í†¡ ìˆ˜ì‹  í›„ <b>êµ¬ë…í•´ì§€ ë™ì˜í•˜ê¸°</b> ë§í¬ ì ‘ì†</li>
      <li>ë§í¬ ë‚´ <b>ì˜ˆìƒ ìœ„ì•½ê¸ˆ í™•ì¸</b></li>
      <li><b>í™˜ê¸‰ë°›ì„ ê³„ì¢Œì •ë³´</b> ì…ë ¥ ì§„í–‰</li>
      <li>ìµœì¢… ê³ ê° ë™ì˜ í›„ <b>í•´ì§€ì‹ ì²­ ì™„ë£Œ</b> ì•Œë¦¼í†¡ ìˆ˜ì‹ </li>
    </ol>
  </div>
  <div class="note">
    <ol>
      <li>ìœ„ì•½ê¸ˆì€ ì”ì—¬ê¸°ê°„ì— ë”°ë¼ ì‚°ì •ë©ë‹ˆë‹¤.</li>
      <li>í•´ì§€ ì‹œ ìƒí’ˆ íšŒìˆ˜ ì ˆì°¨ê°€ ì§„í–‰ë˜ë©°, íšŒìˆ˜ë¹„ìš©ì´ ë°œìƒí•©ë‹ˆë‹¤.</li>
      <li>í•´ì§€ ë™ì˜ ì™„ë£Œ í›„ íšŒìˆ˜ë¹„ ê²°ì œê°€ í•„ìš”í•˜ë©°, ê²°ì œ í™•ì¸ í›„ íšŒìˆ˜ ì¼ì •ì„ ì˜ˆì•½í•©ë‹ˆë‹¤.</li>
      <li>ì „ë¬¸ ê¸°ì‚¬ê°€ ì˜ˆì•½ì¼ì— ë°©ë¬¸í•˜ì—¬ íšŒìˆ˜í•©ë‹ˆë‹¤.</li>
      <li>ìµœì¢… ìœ„ì•½ê¸ˆ ë° íŒŒì†/ë¶„ì‹¤ë£ŒëŠ” ì œí’ˆ íŒì • í›„ ì•ˆë‚´ë©ë‹ˆë‹¤. (ê³„ì•½ì„œ ê¸°ì¤€)</li>
      <li>íšŒì‚¬ëŠ” ì”ì—¬ êµ¬ë…ë£Œì—ì„œ ê³„ì•½ì— ë”°ë¥¸ í•´ì•½ê¸ˆ ë“±ì„ ìƒê³„í•˜ì—¬ ì§€ê¸‰í•©ë‹ˆë‹¤.</li>
    </ol>
  </div>
</div>

<script>
  /* ---------- ìœ í‹¸ ---------- */
  const $ = (id)=>document.getElementById(id);
  const parseNum = v => Number(String(v).replace(/[^\d]/g,'')) || 0;
  const fmt = n => (isNaN(n) ? "-" : n.toLocaleString('ko-KR')+"ì›");
  const fmtPlain = n => n.toLocaleString('ko-KR');
  const monthsText = m => `${m}ê°œì›”(= ${Math.round(m/12)}ë…„)`;
  const todayStr = ()=>{const d=new Date(),p=n=>String(n).padStart(2,'0');return `${d.getFullYear()}-${p(d.getMonth()+1)}-${p(d.getDate())}`};

  function attachComma(id, onChange){
    const el=$(id); if(!el) return;
    el.addEventListener('focus', ()=>{ const raw=parseNum(el.value); el.value= raw? String(raw):''; });
    el.addEventListener('input', ()=> onChange && onChange());
    el.addEventListener('blur', ()=>{ const val=parseNum(el.value); el.value = val? fmtPlain(val):''; onChange && onChange(); });
  }

  /* ---------- ì¼ë°˜/êµ¬ë… ê³„ì‚° ---------- */
  function warrantyByBuy(price){
    const tiers=[[150000,4000],[300000,6000],[500000,7000],[750000,10500],[1000000,14000],[1500000,21000],[2000000,28000],[2500000,35000],[3000000,42000],[3500000,49000],[4000000,56000],[10000000,70000]];
    for(const [max,fee] of tiers){ if(price<=max) return fee; }
    return 70000;
  }
  function applyPreset(){
    const chosen = $('preset').value;
    const valCleaning = $('val_cleaning');
    if(chosen==='NONE'){ valCleaning.value = ""; }
    else{
      const price = +chosen.split('|')[1]||0;
      valCleaning.value = price ? String(price) : "";
    }
    calc(); saveAll();
  }

  /* ---------- ì¸ì‡„ ëª¨ë“œ ---------- */
  let _oldTitle = document.title;
  function safePrintToggle(whichClass){
    document.body.classList.remove('print-pdf','print-penalty-sheet','print-screen');
    if(whichClass) document.body.classList.add(whichClass);
    _oldTitle = document.title;
    document.title = ' ';
    void document.body.offsetHeight;
    requestAnimationFrame(()=> setTimeout(()=> window.print(), 30));
  }
  window.addEventListener('afterprint', ()=>{
    document.body.classList.remove('print-pdf','print-penalty-sheet','print-screen');
    document.title = _oldTitle || document.title;
  });

  /* ---------- ë¹„êµ ê³„ì‚° ---------- */
  function calc(){
    const buyPrice = parseNum($('buy_price').value);
    const subMonthly = parseNum($('sub_monthly').value);
    const months = +$('sub_months').value || 0;
    const cashback = +$('cashback_tier').value || 0;

    const cleaningCnt= +$('cleaning_count').value || 0;
    const valCleaning= parseNum($('val_cleaning').value);
    const preset = $('preset').value;

    const partsIncluded = $('parts_included').checked;
    const valParts = parseNum($('val_parts').value);
    const partsNote = $('parts_note').value || "ì†Œëª¨í’ˆ";

    const benefitManual = parseNum($('benefit_manual').value);

    // ì—°ì¥ë³´ì¦ ìë™/ì…ë ¥ ë°˜ì˜
    const wEl = $('val_warranty');
    const autoW = warrantyByBuy(buyPrice);
    if(document.activeElement!==wEl){ wEl.value = autoW ? fmtPlain(autoW) : ""; }
    const valWarranty = parseNum(wEl.value);

    // êµ¬ë… ì´ì•¡
    const subGross = subMonthly * months;                          // ì›”Ã—ê¸°ê°„
    const initDisc = Math.min(Math.round(subGross * 0.05), 50000); // ìµœì´ˆê²°ì œ 5%(ìµœëŒ€ 5ë§Œì›)
    const subMonthlyAfter = Math.max(subMonthly - cashback, 0);    // ì›” ìºì‹œë°± ë°˜ì˜
    const subMonthlySum   = subMonthlyAfter * months;              // ì›” ë‚©ì… í•©ê³„
    const subTotal        = subMonthlySum - initDisc;              // ì²­êµ¬í• ì¸ ë°˜ì˜ ì´ì•¡

    // ê´€ë¦¬ë¹„(ë³´ì¦Â·ì²­ì†ŒÂ·ë¶€í’ˆ) â€” ì—°ì¥ë³´ì¦ í•­ìƒ í¬í•¨
    const benefitCleaning = (preset==='NONE'?0:(valCleaning * Math.max(cleaningCnt,0)));
    const benefitParts    = (partsIncluded ? valParts : 0);
    const benefitWarranty = valWarranty;
    const benefitTotal    = benefitWarranty + benefitCleaning + benefitParts;

    // ê³„ì‚° ìš”ì•½
    const cbSelected  = cashback * months;
    const finalInclCB = subGross - initDisc - benefitManual - cbSelected;
    const buyNet      = buyPrice - benefitManual;
    const subNet      = (subTotal - benefitTotal) - benefitManual;

    const set=(id,v)=>{const el=$(id); if(el) el.textContent=v;};

    // â­ 3ì¤„ ìš”ì•½
    set('sum_monthly', fmt(subMonthlyAfter));
    set('sum_warranty', monthsText(months));
    set('sum_manage', fmt(benefitTotal));

    // í™”ë©´ KPI
    set('kpi_buy', fmt(buyPrice));
    set('kpi_final_incl_cb', fmt(finalInclCB));
    set('kpi_sub_net', fmt(subNet));

    // ì›” ì‹¤ì  ë°•ìŠ¤
    set('spend_300', fmt(Math.max(subMonthly - 11000, 0)) + ' /ì›”');
    set('spend_700', fmt(Math.max(subMonthly - 15000, 0)) + ' /ì›”');

    // ìƒì„¸í‘œ
    set('t_buy_price', fmt(buyPrice));
    set('t_sub_first', fmt(subGross));
    set('t_sub_monthly', fmt(subMonthlyAfter));
    set('t_sub_monthly_sum', fmt(subMonthlySum));
    set('t_sub_months', monthsText(months));
    set('t_sub_warranty', monthsText(months));
    const cleanTxtScreen = (preset==='NONE')? "ë¯¸í¬í•¨" : `${Math.max(cleaningCnt,0)}íšŒ Ã— ${fmt(valCleaning)} = ${fmt(benefitCleaning)}`;
    set('t_cleaning', cleanTxtScreen);
    const partsTxtScreen = partsIncluded
      ? `í¬í•¨ (${partsNote}) Â· ${fmt(valParts)}`
      : `ë¯¸í¬í•¨${valParts ? ` (${fmt(valParts)})` : ''}`;
    const partsCell = $('t_parts'); if(partsCell) partsCell.innerHTML = partsTxtScreen;
    set('t_buy_total', fmt(buyPrice));
    set('t_sub_total', fmt(subTotal));
    set('t_benefit_value', fmt(benefitTotal));
    set('t_buy_net', fmt(buyNet));
    set('t_sub_net', fmt(subNet));

    // PDF ê°’
    const nameRaw=$('customer_name').value.trim();
    const modelRaw=($('model_name').value||"").toUpperCase();
    set('ps_name', nameRaw? nameRaw+" ê³ ê°ë‹˜":"ê³ ê°ë‹˜");
    set('ps_model', modelRaw||"-");
    const d=new Date(),pad=n=>String(n).padStart(2,"0");
    set('ps_date', `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}`);
    set('ps_sub_total', fmt(subTotal));
    set('ps_final', fmt(finalInclCB - benefitTotal));
    set('ps_buy_total', fmt(buyPrice));
    set('ps_sub_first', fmt(subGross));
    set('ps_sub_monthly', fmt(subMonthlyAfter));
    set('ps_sub_monthly_sum', fmt(subMonthlySum));
    const monthsStr = monthsText(months);
    set('ps_months', monthsStr);
    set('ps_warranty', `ë³´ì¦ ìµœëŒ€(ë³´í—˜í¬í•¨) ${monthsStr}`);
    const cleanTxtPDF = (preset==='NONE') ? "â† í´ë¦¬ë‹ ë¯¸í¬í•¨"
      : `í´ë¦¬ë‹: ${Math.max(cleaningCnt,0)}íšŒ Ã— ${fmt(valCleaning)} = ${fmt(benefitCleaning)}`;
    const partsTxtPDF = (partsIncluded) ? `ë¶€í’ˆ/ì†Œëª¨í’ˆ: í¬í•¨ (${partsNote}) Â· ${fmt(valParts)}` : "â† ì†Œëª¨í’ˆ ë¯¸í¬í•¨";
    $('ps_cleaning').innerHTML = cleanTxtPDF;
    $('ps_parts').innerHTML   = partsTxtPDF;
    set('ps_benefit', fmt(benefitTotal));
    set('ps_buy_net', fmt(buyNet));
    set('ps_sub_net', fmt(subNet));
    set('ps_spend_300', fmt(Math.max(subMonthly - 11000, 0)) + ' /ì›”');
    set('ps_spend_700', fmt(Math.max(subMonthly - 15000, 0)) + ' /ì›”');
  }

  // ì €ì¥/ë³µì›
  const FIELDS=['customer_name','model_name','buy_price','sub_monthly','sub_months','cashback_tier','preset','val_cleaning','cleaning_count','val_warranty','val_parts','parts_included','parts_note','benefit_manual'];
  function saveAll(){
    const data={};
    for(const id of FIELDS){
      const el=$(id); if(!el) continue;
      data[id]=(el.type==='checkbox')? el.checked : el.value;
    }
    try{ localStorage.setItem('ansimcare_v2', JSON.stringify(data)); }catch(e){}
  }
  function restoreAll(){
    try{
      const raw=localStorage.getItem('ansimcare_v2');
      if(!raw) return;
      const data=JSON.parse(raw);
      for(const id of FIELDS){
        const el=$(id); if(!el || !(id in data)) continue;
        if(el.type==='checkbox') el.checked=!!data[id]; else el.value=data[id];
      }
    }catch(e){}
  }

  /* ---------- ìœ„ì•½ê¸ˆ ê³„ì‚° ---------- */
  function rateByUsed(used, contract){
    if(used>=contract) return {rate:0, label:'0% (ê³„ì•½ ì¢…ë£Œ)'};
    if(used<=12) return {rate:0.30, label:'30% (ì‚¬ìš© 1ë…„ ì´ë‚´)'};
    if(used<=24) return {rate:0.20, label:'20% (1ë…„ ì´ˆê³¼~2ë…„ ë¯¸ë§Œ)'};
    return {rate:0.10, label:'10% (2ë…„ ì´ˆê³¼~ì¢…ë£Œ ì „)'};
  }
  function calcPenalty(){
    const contract=+$('contract_months').value||0;
    const monthly=parseNum($('monthly_fee').value);
    const used=parseNum($('used_months').value);

    const sel=$('pickup_item').value;
    let pickup=0;
    if(String(sel).startsWith('custom:')){
      $('pickup_fee').readOnly=false;
      $('pickup_hint').textContent='ê°’ì„ ì§ì ‘ ì…ë ¥í•˜ì„¸ìš”.';
      pickup=parseNum($('pickup_fee').value);
    }else{
      $('pickup_fee').readOnly=true;
      $('pickup_hint').textContent='íšŒìˆ˜ í’ˆëª©ì„ ì„ íƒí•˜ë©´ ìë™ ì…ë ¥ë©ë‹ˆë‹¤.';
      pickup=parseNum(sel);
      $('pickup_fee').value = pickup ? fmtPlain(pickup) : '';
    }

    const remain = Math.max(contract - used, 0);
    const remainTotal = monthly * remain;
    const {rate, label} = rateByUsed(used, contract);
    const penalty = Math.round(remainTotal * rate);
    const total   = penalty + pickup;

    const set=(id,v)=>{const el=$(id); if(el) el.textContent=v;};
    set('net_monthly', fmt(monthly));
    set('remain_total', `${remain}ê°œì›” Â· ${fmt(remainTotal)}`);
    set('rate_text', label);
    set('penalty', fmt(penalty));
    set('pickup', fmt(pickup));
    set('total_due', fmt(total));
    set('out_contract', `${contract}ê°œì›”`);
    set('out_months', `${used}ê°œì›” / ${remain}ê°œì›”`);
    set('out_monthlies', `${fmt(monthly)} / ${fmt(monthly)} (ìˆœ=ì›”ìš”ê¸ˆ)`);
    set('out_remain_sum', fmt(remainTotal));
    set('out_memo', $('memo').value.trim() || '-');
  }

  /* ---------- ê°„í¸ 1ì¥ ì‹œíŠ¸ ì¶œë ¥ ---------- */
  function fillAndPrintPenaltySheet(){
    calcPenalty();
    const contract=+$('contract_months').value||0;
    const monthly=parseNum($('monthly_fee').value);
    const used=parseNum($('used_months').value);
    const remain=Math.max(contract-used,0);
    const pickupSel=$('pickup_item');
    const pickupText=pickupSel.options[pickupSel.selectedIndex]?.text||'ì„ íƒ ì—†ìŒ';
    const pickupValue=parseNum(pickupSel.value||'0');
    const pickupFee=String(pickupSel.value).startsWith('custom:') ? parseNum($('pickup_fee').value) : pickupValue;
    const remainTotal=monthly*remain;
    const {rate,label}=rateByUsed(used,contract);
    const penalty=Math.round(remainTotal*rate);

    $('pp_date').textContent=todayStr();
    $('pp_monthly').textContent=fmt(monthly);
    $('pp_used').textContent=`${used}ê°œì›”`;
    $('pp_remain').textContent=`${remain}ê°œì›”`;
    $('pp_item').textContent=pickupText.replace(/\s*\(.*\)$/,'');
    $('pp_pickup').textContent=fmt(pickupFee);
    $('pp_basis').textContent=label+' ê¸°ì¤€';
    $('pp_remain_total').textContent=fmt(remainTotal);
    $('pp_penalty').textContent=fmt(penalty);

    safePrintToggle('print-penalty-sheet');
  }

  /* ---------- ì´ë²¤íŠ¸ ë°”ì¸ë”© ---------- */
  ['buy_price','sub_monthly','val_cleaning','val_warranty','val_parts','benefit_manual']
    .forEach(id => attachComma(id, ()=>{ calc(); saveAll(); }));
  $('preset').addEventListener('change', applyPreset);
  ['customer_name','model_name','sub_months','cashback_tier','cleaning_count','parts_included','parts_note']
    .forEach(id => $(id).addEventListener('input', ()=>{ calc(); saveAll(); }));

  attachComma('monthly_fee', calcPenalty);
  attachComma('used_months', calcPenalty);
  attachComma('pickup_fee', calcPenalty);
  ['contract_months','pickup_item','memo'].forEach(id=>$(id).addEventListener('input', calcPenalty));

  // ë²„íŠ¼
  $('btnPrintPdf').addEventListener('click', ()=> safePrintToggle('print-pdf'));
  $('btnPrintScreen').addEventListener('click', ()=> safePrintToggle('print-screen'));
  $('btnPenaltyOpen').addEventListener('click', ()=>{ $('penaltyModal').classList.add('open'); setTimeout(calcPenalty,0); });
  $('btnPenaltyClose').addEventListener('click', ()=> $('penaltyModal').classList.remove('open'));
  $('btnPenaltyQuickPrint').addEventListener('click', fillAndPrintPenaltySheet);

  // ì´ˆê¸° ë¡œë“œ
  window.addEventListener('load', ()=>{ restoreAll(); applyPreset(); calc(); calcPenalty(); });
</script>
</body>
</html>
