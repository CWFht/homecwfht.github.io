<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>안심CARE · 일반구매 / 구독구매 비교 + 상담용 요약 PDF</title>
<style>
  body {background:#0a0f1e; color:#e7eefb; font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans KR",Arial,sans-serif;}
  .wrap{max-width:980px;margin:0 auto;padding:18px}
  .card{background:#0f172a;border:1px solid #1f2a44;border-radius:14px;padding:16px;margin-bottom:14px}
  table{width:100%;border-collapse:collapse;margin-top:6px}
  th,td{border-bottom:1px dashed #1f2a44;padding:8px;text-align:left;font-size:14px}
  .highlight{color:#93f1cb;font-weight:700}
  input,select{padding:8px;border-radius:8px;border:1px solid #1f2a44;background:#0b1220;color:#e7eefb;width:100%}
  input:focus,select:focus{outline:2px solid #9bff6a}
  @media print {
    body{background:white;color:#000}
    .card{page-break-inside:avoid;border:1.5px solid #000;color:#000}
    th,td{border:1px solid #000}
    /* 화면용 비교는 출력하지 않음 */
    #screen_compare{display:none}
    /* PDF 요약만 출력 */
    #print_section{display:block}
  }
  /* PDF 요약은 화면에서는 숨김 */
  #print_section{display:none}
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <h2>입력</h2>
    <label>일반 구매가(원) <input id="buy_price" value="1,390,000"></label><br><br>
    <label>구독 월요금(원) <input id="sub_monthly" value="52,300"></label><br><br>
    <label>구독기간
      <select id="sub_months">
        <option value="36">36개월</option>
        <option value="60">60개월</option>
      </select>
    </label><br><br>
    <label>제휴카드 캐시백
      <select id="cashback_tier">
        <option value="0">없음</option>
        <option value="11000">월30만원↑(11,000원)</option>
        <option value="15000">월70만원↑(15,000원)</option>
      </select>
    </label><br><br>
    <label>부품/소모품 환산가(원) <input id="val_parts" value="0"></label><br>
    <label><input type="checkbox" id="parts_included"> 부품/소모품 포함 여부(구독)</label><br>
    <label>부품/소모품 비고 <input id="parts_note" placeholder="예: 배터리교체"></label>
  </div>

  <!-- 화면용 상세 혜택 비교 -->
  <div class="card" id="screen_compare">
    <h2>상세 혜택 비교</h2>
    <table>
      <tr><th>항목</th><th>일반 구매</th><th>구독 구매</th></tr>
      <tr><td>구독구매 최초결제</td><td id="t_buy_price"></td><td id="t_sub_first"></td></tr>
      <tr><td>부품/소모품</td><td>별도구매</td><td id="t_parts"></td></tr>
      <tr><td>혜택 환산가</td><td>-</td><td id="t_benefit_value"></td></tr>
      <tr><td>혜택 적용 후 실질금액</td><td id="t_buy_net"></td><td id="t_sub_net" class="highlight"></td></tr>
    </table>
  </div>

  <!-- PDF 전용 요약 (상세 혜택 포함) -->
  <div class="card" id="print_section">
    <h2>상담용 요약 PDF - 상세 혜택 비교 포함</h2>
    <table>
      <tr><th>항목</th><th>일반 구매</th><th>구독 구매</th></tr>
      <tr><td>구독구매 최초결제</td><td id="p_buy_price"></td><td id="p_sub_first"></td></tr>
      <tr><td>부품/소모품</td><td>별도구매</td><td id="p_parts"></td></tr>
      <tr><td>혜택 환산가</td><td>-</td><td id="p_benefit_value"></td></tr>
      <tr><td>혜택 적용 후 실질금액</td><td id="p_buy_net"></td><td id="p_sub_net" class="highlight"></td></tr>
    </table>
  </div>
</div>

<script>
function parseNum(v){return +String(v).replace(/[^\d]/g,'')||0;}
function fmt(n){return (isNaN(n)?"-":n.toLocaleString('ko-KR')+"원");}

function calc(){
  const buyPrice=parseNum(document.getElementById('buy_price').value);
  const subMonthly=parseNum(document.getElementById('sub_monthly').value);
  const months=+document.getElementById('sub_months').value;
  const cashback=+document.getElementById('cashback_tier').value;
  const valParts=parseNum(document.getElementById('val_parts').value);
  const partsIncluded=document.getElementById('parts_included').checked;
  const partsNote=document.getElementById('parts_note').value;

  const subGross=subMonthly*months;
  const initDisc=Math.min(Math.round(subGross*0.05),50000);
  const subMonthlyAfter=subMonthly-cashback;
  const subMonthlySum=subMonthlyAfter*months;
  const subTotal=subMonthlySum-initDisc;

  const benefitParts=partsIncluded?valParts:0;
  const benefitTotal=benefitParts;

  const subNet=subTotal-benefitTotal;
  const buyNet=buyPrice;

  const partsText=partsIncluded?`포함 (${partsNote||"소모품"}) · ${fmt(valParts)}`:`미포함 ${valParts?"("+fmt(valParts)+")":""}`;

  document.getElementById('t_buy_price').textContent=fmt(buyPrice);
  document.getElementById('t_sub_first').textContent=fmt(subGross);
  document.getElementById('t_parts').innerHTML=partsText;
  document.getElementById('t_benefit_value').textContent=fmt(benefitTotal);
  document.getElementById('t_buy_net').textContent=fmt(buyNet);
  document.getElementById('t_sub_net').textContent=fmt(subNet);

  // PDF section sync
  document.getElementById('p_buy_price').textContent=fmt(buyPrice);
  document.getElementById('p_sub_first').textContent=fmt(subGross);
  document.getElementById('p_parts').innerHTML=partsText;
  document.getElementById('p_benefit_value').textContent=fmt(benefitTotal);
  document.getElementById('p_buy_net').textContent=fmt(buyNet);
  document.getElementById('p_sub_net').textContent=fmt(subNet);
}

['buy_price','sub_monthly','sub_months','cashback_tier','val_parts','parts_included','parts_note']
.forEach(id=>document.getElementById(id).addEventListener('input',calc));

window.addEventListener('load',calc);
</script>
</body>
</html>
